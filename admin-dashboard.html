<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | å¤§å­¦èµ´ä»»è€…ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼å¸¯åŒãƒ—ãƒ­ã‚°ãƒ©ãƒ </title>
  <meta name="description" content="ç®¡ç†è€…å°‚ç”¨ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ - åˆ©ç”¨è€…ç®¡ç†ã€é¢è«‡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã€æ›¸é¡ç¢ºèª" />
  <meta name="robots" content="noindex, nofollow" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Kaku Gothic ProN',
      'Hiragino Sans', Meiryo, sans-serif;
      background: #f5f7fa;
      min-height: 100vh;
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
    .header{
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 15px 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 1000;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .header-left{ display:flex; align-items:center; gap:15px; }
    .header-left i{ font-size:1.8rem; }
    .header-title h1{ font-size:1.5rem; font-weight:600; }
    .header-title p{ font-size:0.85rem; opacity:0.9; margin-top:3px; }
    .header-right{ display:flex; align-items:center; gap:20px; }
    .user-info{ display:flex; align-items:center; gap:10px; }
    .user-avatar{
      width:40px; height:40px; border-radius:50%;
      background:white; display:flex; align-items:center; justify-content:center;
      color:#667eea; font-weight:600;
    }
    .btn-logout{
      padding: 8px 20px;
      background: rgba(255,255,255,0.2);
      border: 1px solid white;
      border-radius: 20px;
      color: white;
      text-decoration: none;
      font-size: 0.9rem;
      transition: all .3s ease;
      cursor: pointer;
    }
    .btn-logout:hover{ background:white; color:#667eea; }

    /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
    .container{ display:flex; min-height: calc(100vh - 70px); }

    /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
    .sidebar{
      width:250px; background:white;
      box-shadow: 2px 0 10px rgba(0,0,0,0.05);
      padding: 20px 0;
    }
    .sidebar-menu{ list-style:none; }
    .sidebar-menu li{ margin-bottom:5px; }
    .sidebar-menu a{
      display:flex; align-items:center; gap:12px;
      padding: 12px 25px;
      color:#666; text-decoration:none;
      transition: all .3s ease;
    }
    .sidebar-menu a:hover, .sidebar-menu a.active{
      background: linear-gradient(90deg, #667eea 0%, transparent 100%);
      color:#667eea;
      border-left:4px solid #667eea;
    }
    .sidebar-menu i{ font-size:1.2rem; width:20px; }

    /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
    .main-content{ flex:1; padding:30px; overflow-y:auto; }

    /* çµ±è¨ˆã‚«ãƒ¼ãƒ‰ */
    .stats-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap:20px;
      margin-bottom:30px;
    }
    .stat-card{
      background:white;
      border-radius:15px;
      padding:25px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      display:flex; align-items:center; gap:20px;
      transition: transform .3s ease;
    }
    .stat-card:hover{
      transform: translateY(-5px);
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }
    .stat-icon{
      width:60px; height:60px;
      border-radius:12px;
      display:flex; align-items:center; justify-content:center;
      font-size:1.8rem;
    }
    .stat-icon.users{ background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:white; }
    .stat-icon.meetings{ background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color:white; }
    .stat-icon.documents{ background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color:white; }
    .stat-icon.applications{ background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color:white; }
    .stat-info h3{ font-size:2rem; color:#333; margin-bottom:5px; }
    .stat-info p{ color:#999; font-size:0.9rem; }

    /* ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
    .section{
      background:white;
      border-radius:15px;
      padding:25px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      margin-bottom:30px;
      display:none;
    }
    .section.active{ display:block; }
    .section-header{
      display:flex; justify-content:space-between; align-items:center;
      margin-bottom:20px; padding-bottom:15px;
      border-bottom:2px solid #f0f0f0;
    }
    .section-title{
      font-size:1.5rem; color:#333;
      display:flex; align-items:center; gap:10px;
    }
    .section-title i{ color:#667eea; }

    /* ãƒœã‚¿ãƒ³ */
    .btn{
      padding: 10px 20px;
      border-radius: 8px;
      border:none;
      cursor:pointer;
      font-size:0.9rem;
      transition: all .3s ease;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .btn-primary{
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color:white;
    }
    .btn-primary:hover{
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102,126,234,0.4);
    }
    .btn-secondary{ background:#f5f7fa; color:#666; }
    .btn-secondary:hover{ background:#e8ecf1; }
    .btn-danger{ background:#c62828; color:white; }
    .btn-danger:hover{ filter: brightness(0.95); }

    /* ãƒ†ãƒ¼ãƒ–ãƒ« */
    .table-container{ overflow-x:auto; }
    table{ width:100%; border-collapse:collapse; }
    thead{ background:#f8f9fa; }
    th{
      padding:15px;
      text-align:left;
      font-weight:600;
      color:#666;
      font-size:0.9rem;
      border-bottom:2px solid #e0e0e0;
      white-space: nowrap;
    }
    td{
      padding:15px;
      border-bottom:1px solid #f0f0f0;
      color:#333;
      vertical-align: middle;
    }
    tbody tr{ transition: background .3s ease; }
    tbody tr:hover{ background:#f8f9fa; }

    /* ãƒãƒƒã‚¸ */
    .badge{
      padding: 5px 12px;
      border-radius:20px;
      font-size:0.8rem;
      font-weight:600;
      display:inline-block;
      white-space: nowrap;
    }
    .badge-success{ background:#d4edda; color:#155724; }
    .badge-warning{ background:#fff3cd; color:#856404; }
    .badge-info{ background:#d1ecf1; color:#0c5460; }
    .badge-danger{ background:#f8d7da; color:#721c24; }

    /* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
    .action-btns{ display:flex; gap:8px; }
    .btn-action{
      width:32px; height:32px;
      border-radius:6px;
      border:none;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      transition: all .3s ease;
    }
    .btn-view{ background:#e3f2fd; color:#1976d2; }
    .btn-view:hover{ background:#1976d2; color:white; }
    .btn-edit{ background:#fff3e0; color:#f57c00; }
    .btn-edit:hover{ background:#f57c00; color:white; }
    .btn-delete{ background:#ffebee; color:#c62828; }
    .btn-delete:hover{ background:#c62828; color:white; }
    .btn-action:disabled{
      opacity: 0.5;
      cursor: not-allowed;
      filter: grayscale(0.3);
    }

    /* æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ */
    .filter-bar{
      display:flex;
      gap:15px;
      margin-bottom:20px;
      flex-wrap:wrap;
      align-items: center;
    }
    .search-box{
      flex:1;
      min-width:250px;
      position:relative;
    }
    .search-box input{
      width:100%;
      padding: 12px 15px 12px 45px;
      border:2px solid #e0e0e0;
      border-radius:8px;
      font-size:0.95rem;
      transition: border-color .3s ease;
    }
    .search-box input:focus{
      outline:none;
      border-color:#667eea;
    }
    .search-box i{
      position:absolute;
      left:15px;
      top:50%;
      transform: translateY(-50%);
      color:#999;
    }
    .filter-select{
      padding: 12px 15px;
      border:2px solid #e0e0e0;
      border-radius:8px;
      font-size:0.95rem;
      cursor:pointer;
      transition: border-color .3s ease;
      background: white;
    }
    .filter-select:focus{
      outline:none;
      border-color:#667eea;
    }

    /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
    .loading{ text-align:center; padding:50px; color:#999; }
    .loading i{ font-size:3rem; animation: spin 1s linear infinite; }
    @keyframes spin{ 100% { transform: rotate(360deg); } }

    /* ç©ºã®çŠ¶æ…‹ */
    .empty-state{
      text-align:center;
      padding: 60px 20px;
      color:#999;
    }
    .empty-state i{
      font-size:4rem;
      margin-bottom:20px;
      opacity:0.3;
    }
    .empty-state h3{
      font-size:1.3rem;
      color:#666;
      margin-bottom:10px;
    }

    /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é¢¨ */
    .calendar-grid{ display:grid; gap:15px; }
    .calendar-day{ background:#f8f9fa; border-radius:10px; padding:15px; }
    .calendar-date{
      font-weight:600;
      color:#667eea;
      margin-bottom:10px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .meeting-item{
      background:white;
      border-left:4px solid #667eea;
      padding:12px;
      border-radius:6px;
      margin-bottom:10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .meeting-time{ font-weight:600; color:#333; margin-bottom:5px; }
    .meeting-user{ color:#666; font-size:0.9rem; }
    .meeting-type{
      display:inline-block;
      padding:3px 8px;
      background:#e3f2fd;
      color:#1976d2;
      border-radius:4px;
      font-size:0.75rem;
      margin-top:5px;
    }

    /* meetingSlots è¡¨ç¤ºï¼ˆã‚«ãƒ¼ãƒ‰ï¼‰ */
    .meeting-day-group{
      background:#f8f9fa;
      border-radius:12px;
      padding:15px;
      margin-bottom:15px;
    }
    .meeting-day-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:12px;
      font-weight:700;
      color:#333;
    }
    .meeting-slot-card{
      background:white;
      border-radius:10px;
      padding:12px 14px;
      margin-bottom:10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.04);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      border-left:4px solid #667eea;
    }
    .slot-left{
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width: 220px;
    }
    .slot-time{ font-weight:700; color:#333; }
    .slot-meta{ color:#666; font-size:0.9rem; }
    .slot-meta small{ color:#999; }
    .slot-right{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .status-badge{
      padding: 5px 10px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 700;
      white-space: nowrap;
    }
    .status-badge.available{ background:#d4edda; color:#155724; }
    .status-badge.booked{ background:#fff3cd; color:#856404; }
    .capacity-badge{
      background:#e3f2fd;
      color:#1976d2;
      padding:5px 10px;
      border-radius:999px;
      font-size:0.8rem;
      font-weight:700;
      white-space: nowrap;
    }

    /* ãƒ¢ãƒ¼ãƒ€ãƒ« */
    .modal{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 20px;
      z-index: 2000;
    }
    .modal.show{ display:flex; }
    .modal-content{
      width: min(720px, 96vw);
      background: white;
      border-radius: 14px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      overflow:hidden;
    }
    .modal-header{
      padding: 16px 18px;
      background: #f8f9fa;
      border-bottom: 1px solid #eee;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .modal-header h3{
      font-size: 1.1rem;
      color:#333;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .modal-close{
      border:none;
      background: transparent;
      cursor:pointer;
      font-size: 1.3rem;
      color:#666;
    }
    .modal-body{ padding: 18px; }
    .modal-footer{
      padding: 14px 18px;
      border-top: 1px solid #eee;
      display:flex;
      justify-content:flex-end;
      gap: 10px;
      background: #fafafa;
    }
    .form-row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .form-group{ margin-bottom: 12px; }
    .form-group label{
      display:block;
      font-weight: 700;
      color:#444;
      margin-bottom: 6px;
    }
    .form-control{
      width:100%;
      padding: 11px 12px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 0.95rem;
      background: white;
    }
    .form-control:focus{
      outline: none;
      border-color: #667eea;
    }
    .help-text{ color:#888; font-size: 0.9rem; margin-top: 6px; }

    /* è¨­å®šã‚¿ãƒ–ï¼ˆç®¡ç†è€…ç®¡ç†ã®è¦‹ãŸç›®ï¼‰ */
    .settings-tabs{
      display:flex;
      gap:10px;
      margin-bottom: 18px;
      border-bottom: 2px solid #e9ecef;
      flex-wrap: wrap;
    }
    .settings-tab{
      padding: 10px 14px;
      border: none;
      cursor: pointer;
      background: transparent;
      font-weight: 700;
      color:#666;
      border-bottom: 3px solid transparent;
    }
    .settings-tab.active{
      color:#667eea;
      border-bottom-color:#667eea;
    }
    .role-badge{
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 800;
      display:inline-block;
      white-space: nowrap;
    }
    .role-super{ background: #ede7f6; color:#5e35b1; }
    .role-admin{ background: #e3f2fd; color:#1976d2; }
    .role-document{ background: #fff3e0; color:#f57c00; }
    .role-meeting{ background: #e8f5e9; color:#2e7d32; }
    .role-unknown{ background: #f5f5f5; color:#666; }

    /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
    @media (max-width: 768px){
      .sidebar{ display:none; }
      .stats-grid{ grid-template-columns: 1fr; }
      .main-content{ padding: 15px; }
      .header{ flex-direction: column; gap: 15px; }
      table{ font-size: 0.85rem; }
      th, td{ padding: 10px; }
      .form-row{ grid-template-columns: 1fr; }
      .meeting-slot-card{ align-items:flex-start; }
      .slot-right{ justify-content:flex-start; }
    }

    /* é¢è«‡æ‹…å½“è€…ç®¡ç†ã‚¿ãƒ– */
    .counselor-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      border-bottom: 2px solid #e1e8ed;
    }

    .tab-btn {
      padding: 12px 24px;
      background: none;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      color: #657786;
      transition: all 0.3s;
    }

    .tab-btn:hover {
      color: #1da1f2;
    }

    .tab-btn.active {
      color: #1da1f2;
      border-bottom-color: #1da1f2;
    }

    .tab-btn i {
      margin-right: 8px;
    }

    .counselor-tab-content {
      display: none;
    }

    .counselor-tab-content.active {
      display: block;
    }

    .counselor-form {
      max-width: 600px;
      margin: 0 auto;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #14171a;
    }

    .form-group input[type="text"],
    .form-group input[type="email"] {
      width: 100%;
      padding: 12px;
      border: 1px solid #e1e8ed;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
    }

    .form-group input[type="text"]:focus,
    .form-group input[type="email"]:focus {
      outline: none;
      border-color: #1da1f2;
    }

    .required {
      color: #e0245e;
    }

    .checkbox-group {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      cursor: pointer;
      padding: 12px;
      border: 1px solid #e1e8ed;
      border-radius: 8px;
      transition: all 0.3s;
    }

    .checkbox-label:hover {
      background: #f7f9fa;
      border-color: #1da1f2;
    }

    .checkbox-label input[type="checkbox"] {
      margin-right: 12px;
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    #counselorUsersTable {
      background: white;
      border-radius: 8px;
      overflow: hidden;
    }

    #counselorUsersTable table {
      width: 100%;
      border-collapse: collapse;
    }

    #counselorUsersTable th {
      background: #f7f9fa;
      padding: 12px;
      text-align: left;
      font-weight: 600;
      color: #14171a;
      border-bottom: 2px solid #e1e8ed;
    }

    #counselorUsersTable td {
      padding: 12px;
      border-bottom: 1px solid #e1e8ed;
    }

    #counselorUsersTable tr:hover {
      background: #f7f9fa;
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: #657786;
    }

    .loading i {
      font-size: 24px;
      margin-right: 8px;
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #657786;
    }

    .empty-state i {
      font-size: 48px;
      color: #e1e8ed;
      margin-bottom: 16px;
    }

    .empty-state h3 {
      font-size: 18px;
      margin-bottom: 8px;
      color: #14171a;
    }
  </style>
</head>

<body>
  <header class="header">
    <div class="header-left">
      <i class="fas fa-shield-alt"></i>
      <div class="header-title">
        <h1>ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
        <p>å¤§å­¦èµ´ä»»è€…ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼å¸¯åŒãƒ—ãƒ­ã‚°ãƒ©ãƒ ï½œåˆ©ç”¨è€…ç®¡ç†ãƒ»é¢è«‡æ ç®¡ç†ãƒ»æ›¸é¡ç¢ºèª</p>
      </div>
    </div>
    <div class="header-right">
      <div class="user-info">
        <div class="user-avatar" id="adminAvatar">ç”°</div>
        <span id="adminName">ç”°ä¸­æ§˜</span>
      </div>
      <button class="btn-logout" onclick="logout()"><i class="fas fa-sign-out-alt"></i> ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
    </div>
  </header>

  <div class="container">
    <aside class="sidebar">
      <ul class="sidebar-menu">
        <li><a href="#" class="active" onclick="showSection('overview')"><i class="fas fa-chart-line"></i> æ¦‚è¦</a></li>
        <li><a href="#" onclick="showSection('users')"><i class="fas fa-users"></i> åˆ©ç”¨è€…ä¸€è¦§</a></li>
        <li><a href="#" onclick="showSection('counselors')"><i class="fas fa-user-tie"></i> é¢è«‡æ‹…å½“è€…ç®¡ç†</a></li>
        <li><a href="#" onclick="showSection('meetings')"><i class="fas fa-calendar-alt"></i> é¢è«‡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</a></li>
        <li><a href="#" onclick="showSection('documents')"><i class="fas fa-folder-open"></i> æ›¸é¡ç®¡ç†</a></li>
        <li><a href="#" onclick="showSection('stats')"><i class="fas fa-chart-pie"></i> çµ±è¨ˆæƒ…å ±</a></li>
        <li><a href="manual.html"><i class="fas fa-book"></i> ãƒãƒ‹ãƒ¥ã‚¢ãƒ«</a></li>
        <li><a href="#" onclick="showSection('settings')"><i class="fas fa-cog"></i> è¨­å®š</a></li>
      </ul>
    </aside>

    <main class="main-content">
      <!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon users"><i class="fas fa-users"></i></div>
          <div class="stat-info"><h3 id="totalUsers">-</h3><p>ç™»éŒ²åˆ©ç”¨è€…æ•°</p></div>
        </div>
        <div class="stat-card">
          <div class="stat-icon meetings"><i class="fas fa-calendar-check"></i></div>
          <div class="stat-info"><h3 id="totalMeetings">-</h3><p>é¢è«‡äºˆå®šæ•°</p></div>
        </div>
        <div class="stat-card">
          <div class="stat-icon documents"><i class="fas fa-file-alt"></i></div>
          <div class="stat-info"><h3 id="totalDocuments">-</h3><p>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ›¸é¡</p></div>
        </div>
        <div class="stat-card">
          <div class="stat-icon applications"><i class="fas fa-briefcase"></i></div>
          <div class="stat-info"><h3 id="totalApplications">-</h3><p>å¿œå‹Ÿä¸­</p></div>
        </div>
      </div>

      <!-- æ¦‚è¦ -->
      <section class="section active" id="section-overview">
        <div class="section-header">
          <div class="section-title"><i class="fas fa-chart-line"></i> æ¦‚è¦</div>
          <div></div>
        </div>
        <div id="recentActivity">
          <!-- Will be filled by displayOverview() -->
        </div>
      </section>

      <!-- åˆ©ç”¨è€…ä¸€è¦§ -->
      <section class="section" id="section-users">
        <div class="section-header">
          <div class="section-title"><i class="fas fa-users"></i> åˆ©ç”¨è€…ä¸€è¦§</div>
          <button class="btn btn-primary" onclick="alert('åˆ©ç”¨è€…è¿½åŠ æ©Ÿèƒ½ã¯ä»Šå¾Œå®Ÿè£…äºˆå®šã§ã™')">
            <i class="fas fa-user-plus"></i> æ–°è¦ç™»éŒ²
          </button>
        </div>

        <div class="filter-bar">
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input id="userSearch" type="text" placeholder="åˆ©ç”¨è€…åã‚„ãƒ¡ãƒ¼ãƒ«ã§æ¤œç´¢..." oninput="applyUserFilter()" />
          </div>
          <select id="userStatusFilter" class="filter-select" onchange="applyUserFilter()">
            <option value="all">ã™ã¹ã¦</option>
            <option value="active">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–</option>
            <option value="inactive">éã‚¢ã‚¯ãƒ†ã‚£ãƒ–</option>
          </select>
        </div>

        <div class="table-container" id="usersTable">
          <div class="loading"><i class="fas fa-spinner"></i><p style="margin-top:10px;">èª­ã¿è¾¼ã¿ä¸­...</p></div>
        </div>
      </section>

      <!-- é¢è«‡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« -->
      <section class="section" id="section-meetings">
        <div class="section-header">
          <div class="section-title"><i class="fas fa-calendar-alt"></i> é¢è«‡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†</div>
          <button class="btn btn-primary" onclick="showAddSlotModal()">
            <i class="fas fa-plus"></i> é¢è«‡æ ã‚’è¿½åŠ 
          </button>
        </div>

        <div class="filter-bar">
          <select id="meetingDateFilter" class="filter-select" onchange="applyMeetingFilter()">
            <option value="all">å…¨æ—¥ç¨‹</option>
            <option value="upcoming" selected>ä»Šå¾Œ</option>
            <option value="today">ä»Šæ—¥</option>
            <option value="week">ä»Šé€±</option>
            <option value="month">ä»Šæœˆ</option>
          </select>
          <select id="meetingStatusFilter" class="filter-select" onchange="applyMeetingFilter()">
            <option value="all">ã™ã¹ã¦</option>
            <option value="available">ç©ºã</option>
            <option value="booked">äºˆç´„æ¸ˆ</option>
          </select>
        </div>

        <div id="meetingSlotsContainer">
          <!-- Will be filled by displayMeetingSlots() -->
        </div>
      </section>

      <!-- æ›¸é¡ç®¡ç† -->
      <section class="section" id="section-documents">
        <div class="section-header">
          <div class="section-title"><i class="fas fa-folder-open"></i> æ›¸é¡ç®¡ç†</div>
          <div></div>
        </div>

        <div class="filter-bar">
          <select id="documentUserFilter" class="filter-select" onchange="applyDocumentFilter()">
            <option value="">ã™ã¹ã¦ã®åˆ©ç”¨è€…</option>
          </select>
          <select id="documentTypeFilter" class="filter-select" onchange="applyDocumentFilter()">
            <option value="">ã™ã¹ã¦ã®ç¨®é¡</option>
            <option value="resume">å±¥æ­´æ›¸</option>
            <option value="cv">è·å‹™çµŒæ­´æ›¸</option>
            <option value="cover_letter">ã‚«ãƒãƒ¼ãƒ¬ã‚¿ãƒ¼</option>
            <option value="certificate">è³‡æ ¼è¨¼æ˜æ›¸</option>
            <option value="portfolio">ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª</option>
            <option value="other">ãã®ä»–</option>
          </select>
        </div>

        <div class="table-container" id="documentsTable">
          <div class="loading"><i class="fas fa-spinner"></i><p style="margin-top:10px;">èª­ã¿è¾¼ã¿ä¸­...</p></div>
        </div>
      </section>

      <!-- çµ±è¨ˆæƒ…å ± -->
      <section class="section" id="section-stats">
        <div class="section-header">
          <div class="section-title"><i class="fas fa-chart-pie"></i> çµ±è¨ˆæƒ…å ±</div>
          <div></div>
        </div>
        <div class="empty-state">
          <i class="fas fa-chart-pie"></i>
          <h3>çµ±è¨ˆæ©Ÿèƒ½ã¯ä»Šå¾Œæ‹¡å……äºˆå®šã§ã™</h3>
          <p style="color:#999;">ç¾åœ¨ã¯ä¸Šéƒ¨ã®ã‚«ã‚¦ãƒ³ãƒˆè¡¨ç¤ºã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚</p>
        </div>
      </section>

      <!-- è¨­å®š -->
      <!-- é¢è«‡æ‹…å½“è€…ç®¡ç†ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <section class="section" id="section-counselors">
        <div class="section-header">
          <div class="section-title"><i class="fas fa-user-tie"></i> é¢è«‡æ‹…å½“è€…ç®¡ç†</div>
        </div>

        <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <div class="counselor-tabs">
          <button class="tab-btn active" onclick="showCounselorTab('user-list')">
            <i class="fas fa-users"></i> ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§
          </button>
          <button class="tab-btn" onclick="showCounselorTab('counselor-register')">
            <i class="fas fa-user-plus"></i> é¢è«‡æ‹…å½“è€…ç™»éŒ²
          </button>
        </div>

        <!-- ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã‚¿ãƒ– -->
        <div class="counselor-tab-content active" id="tab-user-list">
          <div class="section-header">
            <h3>ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ï¼ˆç®¡ç†è€…é™¤å¤–ï¼‰</h3>
          </div>
          <div id="counselorUsersTable" class="loading">
            <i class="fas fa-spinner fa-spin"></i> ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...
          </div>
        </div>

        <!-- é¢è«‡æ‹…å½“è€…ç™»éŒ²ã‚¿ãƒ– -->
        <div class="counselor-tab-content" id="tab-counselor-register">
          <div class="section-header">
            <h3>é¢è«‡æ‹…å½“è€…ã‚’ç™»éŒ²</h3>
          </div>
          <form id="counselorRegisterForm" class="counselor-form">
            <div class="form-group">
              <label for="counselorName">é¢è«‡æ‹…å½“è€…æ°å <span class="required">*</span></label>
              <input type="text" id="counselorName" name="counselorName" required placeholder="ä¾‹: ç”°ä¸­å¤ªéƒ">
            </div>

            <div class="form-group">
              <label for="counselorEmail">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span class="required">*</span></label>
              <input type="email" id="counselorEmail" name="counselorEmail" required placeholder="ä¾‹: tanaka@example.com">
            </div>

            <div class="form-group">
              <label>é¢è«‡å¯èƒ½é …ç›®</label>
              <div class="checkbox-group">
                <label class="checkbox-label">
                  <input type="checkbox" name="category" value="8">
                  <span>åˆæœŸé¢è«‡</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" name="category" value="4">
                  <span>å°±è·ã‚µãƒãƒ¼ãƒˆé¢è«‡</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" name="category" value="2">
                  <span>å°±è·å¿œå‹Ÿæ›¸é¡ã‚µãƒãƒ¼ãƒˆé¢è«‡</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" name="category" value="1">
                  <span>ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—é¢è«‡</span>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" name="isSuperAdmin" id="isSuperAdmin">
                <span>ã‚¹ãƒ¼ãƒ‘ãƒ¼ç®¡ç†è€…ã¨ã—ã¦ç™»éŒ²</span>
              </label>
            </div>

            <button type="submit" class="btn btn-primary">
              <i class="fas fa-save"></i> ç™»éŒ²
            </button>
          </form>
        </div>
      </section>
      <section class="section" id="section-settings">
        <div class="section-header">
          <div class="section-title"><i class="fas fa-cog"></i> è¨­å®š</div>
          <div></div>
        </div>

        <div class="settings-tabs">
          <button class="settings-tab active" onclick="showSettingsTab('admins')">ç®¡ç†è€…</button>
          <button class="settings-tab" onclick="showSettingsTab('system')">ã‚·ã‚¹ãƒ†ãƒ </button>
        </div>

        <!-- ç®¡ç†è€…ã‚¿ãƒ– -->
        <div id="settings-admins">
          <div class="filter-bar" style="margin-top: 5px;">
            <button class="btn btn-primary" onclick="showAddAdminModal()">
              <i class="fas fa-user-shield"></i> ç®¡ç†è€…ã‚’è¿½åŠ 
            </button>
            <button class="btn btn-secondary" onclick="loadAdmins()">
              <i class="fas fa-rotate"></i> å†èª­ã¿è¾¼ã¿
            </button>
          </div>

          <div id="adminsTable">
            <div class="loading"><i class="fas fa-spinner"></i><p style="margin-top:10px;">èª­ã¿è¾¼ã¿ä¸­...</p></div>
          </div>

          <p class="help-text">
            â€» ç®¡ç†è€…ã®è¿½åŠ å¾Œã€å¿…è¦ã«å¿œã˜ã¦ Firebase Authentication å´ã§ã‚‚è©²å½“ãƒ¡ãƒ¼ãƒ«ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆã‚’ã”æ¤œè¨ãã ã•ã„ã€‚
          </p>
        </div>

        <!-- ã‚·ã‚¹ãƒ†ãƒ ã‚¿ãƒ– -->
        <div id="settings-system" style="display:none;">
          <div class="empty-state">
            <i class="fas fa-screwdriver-wrench"></i>
            <h3>ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã¯æº–å‚™ä¸­ã§ã™</h3>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- é¢è«‡æ è¿½åŠ ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal" id="addSlotModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="fas fa-calendar-plus"></i> é¢è«‡æ ã‚’æ–°è¦è¿½åŠ </h3>
        <button class="modal-close" onclick="closeAddSlotModal()"><i class="fas fa-times"></i></button>
      </div>
      <form id="addSlotForm">
        <div class="modal-body">
          <div class="form-row">
            <div class="form-group">
              <label><i class="fas fa-calendar-day"></i> æ—¥ä»˜ <span style="color:red">*</span></label>
              <input type="date" id="slotDate" class="form-control" required />
            </div>
            <div class="form-group">
              <label><i class="fas fa-users"></i> å®šå“¡ <span style="color:red">*</span></label>
              <input type="number" id="slotCapacity" class="form-control" min="1" max="10" value="1" required />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label><i class="fas fa-clock"></i> é–‹å§‹æ™‚é–“ <span style="color:red">*</span></label>
              <input type="time" id="slotStartTime" class="form-control" required />
            </div>
            <div class="form-group">
              <label><i class="fas fa-clock"></i> çµ‚äº†æ™‚é–“ <span style="color:red">*</span></label>
              <input type="time" id="slotEndTime" class="form-control" required />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label><i class="fas fa-comments"></i> é¢è«‡ã‚¿ã‚¤ãƒ— <span style="color:red">*</span></label>
              <select id="slotType" class="form-control" required>
                <option value="åˆå›ã‚­ãƒ£ãƒªã‚¢é¢è«‡">åˆå›ã‚­ãƒ£ãƒªã‚¢é¢è«‡</option>
                <option value="ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—é¢è«‡">ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—é¢è«‡</option>
                <option value="ä¼æ¥­ç´¹ä»‹é¢è«‡">ä¼æ¥­ç´¹ä»‹é¢è«‡</option>
                <option value="å¿œå‹Ÿæ›¸é¡æ·»å‰Š">å¿œå‹Ÿæ›¸é¡æ·»å‰Š</option>
                <option value="é¢æ¥å¯¾ç­–">é¢æ¥å¯¾ç­–</option>
                <option value="ãã®ä»–">ãã®ä»–</option>
              </select>
            </div>
            <div class="form-group">
              <label><i class="fas fa-map-marker-alt"></i> å ´æ‰€ <span style="color:red">*</span></label>
              <select id="slotLocation" class="form-control" required>
                <option value="ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼ˆZoomï¼‰">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼ˆZoomï¼‰</option>
                <option value="ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼ˆGoogle Meetï¼‰">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼ˆGoogle Meetï¼‰</option>
                <option value="å¯¾é¢">å¯¾é¢</option>
                <option value="ãã®ä»–">ãã®ä»–</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label><i class="fas fa-link"></i> ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒªãƒ³ã‚¯ï¼ˆä»»æ„ï¼‰</label>
            <input type="url" id="slotMeetingLink" class="form-control" placeholder="https://..." />
            <div class="help-text">è¿½åŠ æ ã¯äºˆç´„ãƒšãƒ¼ã‚¸ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚</div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" onclick="closeAddSlotModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button type="submit" class="btn btn-primary"><i class="fas fa-plus"></i> è¿½åŠ </button>
        </div>
      </form>
    </div>
  </div>

  <!-- é¢è«‡æ ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal" id="editSlotModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="fas fa-pen"></i> é¢è«‡æ ã‚’ç·¨é›†</h3>
        <button class="modal-close" onclick="closeEditSlotModal()"><i class="fas fa-times"></i></button>
      </div>
      <form id="editSlotForm">
        <div class="modal-body">
          <input type="hidden" id="editSlotId" />

          <div class="form-row">
            <div class="form-group">
              <label>æ—¥ä»˜</label>
              <input type="text" id="editSlotDate" class="form-control" disabled />
            </div>
            <div class="form-group">
              <label>æ™‚é–“</label>
              <input type="text" id="editSlotTime" class="form-control" disabled />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label><i class="fas fa-comments"></i> é¢è«‡ã‚¿ã‚¤ãƒ— <span style="color:red">*</span></label>
              <select id="editSlotType" class="form-control" required>
                <option value="åˆå›ã‚­ãƒ£ãƒªã‚¢é¢è«‡">åˆå›ã‚­ãƒ£ãƒªã‚¢é¢è«‡</option>
                <option value="ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—é¢è«‡">ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—é¢è«‡</option>
                <option value="ä¼æ¥­ç´¹ä»‹é¢è«‡">ä¼æ¥­ç´¹ä»‹é¢è«‡</option>
                <option value="å¿œå‹Ÿæ›¸é¡æ·»å‰Š">å¿œå‹Ÿæ›¸é¡æ·»å‰Š</option>
                <option value="é¢æ¥å¯¾ç­–">é¢æ¥å¯¾ç­–</option>
                <option value="ãã®ä»–">ãã®ä»–</option>
              </select>
            </div>
            <div class="form-group">
              <label><i class="fas fa-map-marker-alt"></i> å ´æ‰€ <span style="color:red">*</span></label>
              <select id="editSlotLocation" class="form-control" required>
                <option value="ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼ˆZoomï¼‰">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼ˆZoomï¼‰</option>
                <option value="ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼ˆGoogle Meetï¼‰">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼ˆGoogle Meetï¼‰</option>
                <option value="å¯¾é¢">å¯¾é¢</option>
                <option value="ãã®ä»–">ãã®ä»–</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label><i class="fas fa-link"></i> ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒªãƒ³ã‚¯ï¼ˆä»»æ„ï¼‰</label>
            <input type="url" id="editSlotMeetingLink" class="form-control" placeholder="https://..." />
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" onclick="closeEditSlotModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> ä¿å­˜</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ç®¡ç†è€…è¿½åŠ ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal" id="addAdminModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="fas fa-user-shield"></i> ç®¡ç†è€…ã‚’è¿½åŠ </h3>
        <button class="modal-close" onclick="closeAddAdminModal()"><i class="fas fa-times"></i></button>
      </div>
      <form id="addAdminForm">
        <div class="modal-body">
          <div class="form-group">
            <label><i class="fas fa-envelope"></i> ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span style="color:red">*</span></label>
            <input type="email" id="adminEmail" class="form-control" placeholder="admin@example.com" required />
          </div>
          <div class="form-group">
            <label><i class="fas fa-user-tag"></i> æ¨©é™ãƒ¬ãƒ™ãƒ« <span style="color:red">*</span></label>
            <select id="adminRole" class="form-control" required>
              <option value="super_admin">ã‚¹ãƒ¼ãƒ‘ãƒ¼ç®¡ç†è€…</option>
              <option value="admin">ä¸€èˆ¬ç®¡ç†è€…</option>
              <option value="document_admin">æ›¸é¡ç®¡ç†è€…</option>
              <option value="meeting_admin">é¢è«‡ç®¡ç†è€…</option>
            </select>
            <div class="help-text">â€» ã“ã®ã€Œadminsã€æ¨©é™ã¯ã€users/{uid}.roleï¼ˆadmin/superadminï¼‰ã¨ã¯åˆ¥æ¦‚å¿µã§ã™ã€‚</div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" onclick="closeAddAdminModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button type="submit" class="btn btn-primary"><i class="fas fa-plus"></i> è¿½åŠ </button>
        </div>
      </form>
    </div>
  </div>

  <!-- ç®¡ç†è€…ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal" id="editAdminModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="fas fa-pen"></i> ç®¡ç†è€…ã‚’ç·¨é›†</h3>
        <button class="modal-close" onclick="closeEditAdminModal()"><i class="fas fa-times"></i></button>
      </div>
      <form id="editAdminForm">
        <div class="modal-body">
          <input type="hidden" id="editAdminId" />
          <div class="form-group">
            <label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
            <input type="email" id="editAdminEmail" class="form-control" disabled />
          </div>
          <div class="form-group">
            <label>æ¨©é™ãƒ¬ãƒ™ãƒ«</label>
            <select id="editAdminRole" class="form-control" required>
              <option value="super_admin">ã‚¹ãƒ¼ãƒ‘ãƒ¼ç®¡ç†è€…</option>
              <option value="admin">ä¸€èˆ¬ç®¡ç†è€…</option>
              <option value="document_admin">æ›¸é¡ç®¡ç†è€…</option>
              <option value="meeting_admin">é¢è«‡ç®¡ç†è€…</option>
            </select>
          </div>
          <div class="help-text">æ›´æ–°æ™‚ã« updatedAt / updatedBy ã‚’è¨˜éŒ²ã—ã¾ã™ã€‚</div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" onclick="closeEditAdminModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> ä¿å­˜</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ç®¡ç†è€…å‰Šé™¤ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal" id="deleteAdminModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="fas fa-trash"></i> ç®¡ç†è€…ã‚’å‰Šé™¤</h3>
        <button class="modal-close" onclick="closeDeleteAdminModal()"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="deleteAdminId" />
        <p>ä»¥ä¸‹ã®ç®¡ç†è€…ã‚’å‰Šé™¤ã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ</p>
        <p style="margin-top:10px; font-weight:800; color:#c62828;" id="deleteAdminEmail">-</p>
        <p class="help-text">â€» Firestoreã‹ã‚‰å‰Šé™¤å¾Œã€å¿…è¦ã«å¿œã˜ã¦ Firebase Authentication å´ã§ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤ã‚‚ã”æ¤œè¨ãã ã•ã„ã€‚</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="closeDeleteAdminModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="button" class="btn btn-danger" onclick="confirmDeleteAdmin()"><i class="fas fa-trash"></i> å‰Šé™¤</button>
      </div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script type="module">
    
// <script>
// ============================================================
// ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°å®šç¾©ï¼ˆinline onclick ã‹ã‚‰å‘¼ã¹ã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼‰
// ============================================================

// é¢è«‡æ è¿½åŠ ãƒ¢ãƒ¼ãƒ€ãƒ«
window.showAddSlotModal = function() {
  const modal = document.getElementById('addSlotModal');
  if (!modal) {
    console.error('addSlotModal ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
    return;
  }
  
  const today = new Date();
  const yyyy = today.getFullYear();
  const mm = String(today.getMonth() + 1).padStart(2, '0');
  const dd = String(today.getDate()).padStart(2, '0');
  
  document.getElementById('slotDate').value = `${yyyy}-${mm}-${dd}`;
  document.getElementById('slotStartTime').value = '10:00';
  document.getElementById('slotEndTime').value = '11:00';
  document.getElementById('slotCapacity').value = '1';
  
  modal.classList.add('show');
};

window.closeAddSlotModal = function() {
  const modal = document.getElementById('addSlotModal');
  if (modal) {
    modal.classList.remove('show');
  }
};

// é¢è«‡æ ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«
window.closeEditSlotModal = function() {
  const modal = document.getElementById('editSlotModal');
  if (modal) {
    modal.classList.remove('show');
  }
};

// ç®¡ç†è€…è¿½åŠ ãƒ¢ãƒ¼ãƒ€ãƒ«
window.showAddAdminModal = function() {
  const modal = document.getElementById('addAdminModal');
  if (!modal) {
    console.error('addAdminModal ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
    return;
  }
  
  // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
  document.getElementById('addAdminForm').reset();
  modal.classList.add('show');
};

window.closeAddAdminModal = function() {
  const modal = document.getElementById('addAdminModal');
  if (modal) {
    modal.classList.remove('show');
  }
};

// ç®¡ç†è€…ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«
window.closeEditAdminModal = function() {
  const modal = document.getElementById('editAdminModal');
  if (modal) {
    modal.classList.remove('show');
  }
};

// ç®¡ç†è€…å‰Šé™¤ãƒ¢ãƒ¼ãƒ€ãƒ«
window.closeDeleteAdminModal = function() {
  const modal = document.getElementById('deleteAdminModal');
  if (modal) {
    modal.classList.remove('show');
  }
};

// ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆ
window.showSection = function(sectionName) {
  document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
  document.querySelectorAll('.sidebar-menu a').forEach(link => link.classList.remove('active'));
  
  const targetSection = document.getElementById(`section-${sectionName}`);
  if (targetSection) {
    targetSection.classList.add('active');
  }
  
  event?.target.classList.add('active');
  
  // é¢è«‡æ‹…å½“è€…ç®¡ç†ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã‚’èª­ã¿è¾¼ã‚€
  if (sectionName === 'counselors') {
    loadCounselorUsers();
  }
};

    // é¢è«‡æ‹…å½“è€…ç®¡ç†: ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
    window.showCounselorTab = function(tabName) {
      // ã™ã¹ã¦ã®ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã® active ã‚’è§£é™¤
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // ã™ã¹ã¦ã®ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤º
      document.querySelectorAll('.counselor-tab-content').forEach(content => {
        content.classList.remove('active');
      });
      
      // ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚¿ãƒ–ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
      event.target.closest('.tab-btn').classList.add('active');
      document.getElementById(`tab-${tabName}`).classList.add('active');
      
      console.log(`ğŸ”„ ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ: ${tabName}`);
    };

    // é¢è«‡æ‹…å½“è€…ç®¡ç†: ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã‚’èª­ã¿è¾¼ã¿
    async function loadCounselorUsers() {
      console.log('ğŸ“‹ ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã‚’èª­ã¿è¾¼ã¿ä¸­...');
      const container = document.getElementById('counselorUsersTable');
      
      try {
        // users ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
        const usersRef = collection(db, 'users');
        const q = query(usersRef, orderBy('createdAt', 'desc'));
        const querySnapshot = await getDocs(q);
        
        console.log(`âœ… ${querySnapshot.size} ä»¶ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å–å¾—`);
        
        // ç®¡ç†è€…ä»¥å¤–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        const regularUsers = [];
        querySnapshot.forEach((doc) => {
          const data = doc.data();
          const role = data.role || 'user';
          
          // admin ã¨ superadmin ã‚’é™¤å¤–
          if (role !== 'admin' && role !== 'superadmin') {
            regularUsers.push({
              id: doc.id,
              ...data
            });
          }
        });
        
        console.log(`âœ… ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼: ${regularUsers.length} ä»¶ï¼ˆç®¡ç†è€…ã‚’é™¤å¤–ï¼‰`);
        
        if (regularUsers.length === 0) {
          container.innerHTML = `
            <div class="empty-state">
              <i class="fas fa-users"></i>
              <h3>ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã„ã¾ã›ã‚“</h3>
              <p>ç®¡ç†è€…ä»¥å¤–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
            </div>
          `;
          return;
        }
        
        // ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ
        let tableHTML = `
          <table>
            <thead>
              <tr>
                <th>No.</th>
                <th>åå‰</th>
                <th>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</th>
                <th>ãƒ­ãƒ¼ãƒ«</th>
                <th>ç™»éŒ²æ—¥</th>
                <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
              </tr>
            </thead>
            <tbody>
        `;
        
        let index = 1;
        regularUsers.forEach((user) => {
          const name = user.name || 'æœªè¨­å®š';
          const email = user.email || 'æœªè¨­å®š';
          const role = user.role || 'user';
          const createdAt = user.createdAt ? user.createdAt.toDate().toLocaleDateString('ja-JP') : 'ä¸æ˜';
          const isActive = user.isActive !== false;
          
          tableHTML += `
            <tr>
              <td>${index}</td>
              <td>${name}</td>
              <td>${email}</td>
              <td>${role}</td>
              <td>${createdAt}</td>
              <td>
                <span class="badge ${isActive ? 'badge-active' : 'badge-inactive'}">
                  ${isActive ? 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ–' : 'éã‚¢ã‚¯ãƒ†ã‚£ãƒ–'}
                </span>
              </td>
            </tr>
          `;
          index++;
        });
        
        tableHTML += `
            </tbody>
          </table>
        `;
        
        container.innerHTML = tableHTML;
        console.log('âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã®è¡¨ç¤ºå®Œäº†');
        
      } catch (error) {
        console.error('âŒ ãƒ¦ãƒ¼ã‚¶ãƒ¼èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-exclamation-circle"></i>
            <h3>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</h3>
            <p>${error.message}</p>
          </div>
        `;
      }
    }

    // é¢è«‡æ‹…å½“è€…ç®¡ç†: é¢è«‡æ‹…å½“è€…ã‚’ç™»éŒ²
    async function registerCounselor(formData) {
      console.log('ğŸ“ é¢è«‡æ‹…å½“è€…ç™»éŒ²é–‹å§‹...');
      
      try {
        // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®å€¤ã‚’åˆè¨ˆï¼ˆãƒ“ãƒƒãƒˆãƒã‚¹ã‚¯ï¼‰
        let availableCategories = 0;
        const checkboxes = document.querySelectorAll('input[name="category"]:checked');
        checkboxes.forEach(checkbox => {
          availableCategories += parseInt(checkbox.value);
        });
        
        const isSuperAdmin = document.getElementById('isSuperAdmin').checked;
        
        const counselorData = {
          name: formData.get('counselorName'),
          email: formData.get('counselorEmail'),
          availableCategories: availableCategories,
          isSuperAdmin: isSuperAdmin,
          createdAt: serverTimestamp()
        };
        
        console.log('ğŸ’¾ ä¿å­˜ãƒ‡ãƒ¼ã‚¿:', counselorData);
        
        // Firestore ã«ä¿å­˜
        const docRef = await addDoc(collection(db, 'admins'), counselorData);
        
        console.log('âœ… é¢è«‡æ‹…å½“è€…ã‚’ç™»éŒ²ã—ã¾ã—ãŸ:', docRef.id);
        alert('é¢è«‡æ‹…å½“è€…ã‚’ç™»éŒ²ã—ã¾ã—ãŸï¼');
        
        // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
        document.getElementById('counselorRegisterForm').reset();
        
      } catch (error) {
        console.error('âŒ ç™»éŒ²ã‚¨ãƒ©ãƒ¼:', error);
        alert('ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
      }
    }

    // é¢è«‡æ‹…å½“è€…ç®¡ç†: ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('counselorRegisterForm');
      if (form) {
        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          
          const submitBtn = e.target.querySelector('button[type="submit"]');
          submitBtn.disabled = true;
          submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ç™»éŒ²ä¸­...';
          
          const formData = new FormData(e.target);
          await registerCounselor(formData);
          
          submitBtn.disabled = false;
          submitBtn.innerHTML = '<i class="fas fa-save"></i> ç™»éŒ²';
        });
      }
    });

// è¨­å®šã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
window.showSettingsTab = function(tabName) {
  document.querySelectorAll('.settings-tab').forEach(tab => tab.classList.remove('active'));
  event?.target.classList.add('active');
  
  document.getElementById('settings-admins').style.display = tabName === 'admins' ? 'block' : 'none';
  document.getElementById('settings-system').style.display = tabName === 'system' ? 'block' : 'none';
};

// ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
window.logout = async function() {
  if (confirm('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
    try {
      const { getAuth, signOut } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js');
      await signOut(getAuth());
      window.location.href = 'log-in.html';
    } catch (error) {
      console.error('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã‚¨ãƒ©ãƒ¼:', error);
      alert('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ');
    }
  }
};
</script>

<script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
    import {
      getFirestore, collection, query, where, orderBy, limit as firestoreLimit, getDocs,
      doc, getDoc, setDoc, addDoc, updateDoc, deleteDoc, Timestamp, serverTimestamp
    } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    // Firebaseè¨­å®š
    const firebaseConfig = {
      apiKey: "AIzaSyA6iFUhXOueccuoLJVU9ZSvXywHmj8zoR4",
      authDomain: "university-relocation-support.firebaseapp.com",
      projectId: "university-relocation-support",
      storageBucket: "university-relocation-support.firebasestorage.app",
      messagingSenderId: "849634495988",
      appId: "1:849634495988:web:013663976b0c4d6b4f7da1",
      measurementId: "G-RJP20TC7DV"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // äº’æ›ç”¨ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼è¦ä»¶ï¼‰
    window.firebaseAuth = auth;
    window.firebaseDB = db;

    // ================================
    // role/ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå…±é€š
    // ================================
    async function ensureUserDoc(user) {
      if (!user) return null;

      const uid = user.uid;
      const email = user.email || '';
      const userRef = doc(db, 'users', uid);

      const snap = await getDoc(userRef);
      if (snap.exists()) {
        return snap.data();
      }

      // æœªä½œæˆãªã‚‰ role=user ã§è‡ªå‹•ä½œæˆ
      const nameFromEmail = email ? email.split('@')[0] : 'user';
      const newDoc = {
        uid,
        email,
        name: nameFromEmail,
        role: 'user',
        createdAt: serverTimestamp()
      };

      await setDoc(userRef, newDoc, { merge: true });
      return newDoc;
    }

    async function getUserRoleOrDefault(user) {
      try {
        const data = await ensureUserDoc(user);
        const role = (data && data.role) ? data.role : 'user';
        return role;
      } catch (e) {
        console.error('roleå–å¾—/ãƒ¦ãƒ¼ã‚¶ãƒ¼è‡ªå‹•ä½œæˆã‚¨ãƒ©ãƒ¼:', e);
        return 'user'; // å®‰å…¨å´
      }
    }

    async function requireAdminRoleOrRedirect(user) {
      if (!user) {
        window.location.href = 'log-in.html';
        return false;
      }

      const role = await getUserRoleOrDefault(user);

      // ç®¡ç†ç”»é¢ã®è¨±å¯: admin / superadmin
      if (role !== 'admin' && role !== 'superadmin') {
        alert('ç®¡ç†è€…æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“');
        window.location.href = 'dashboard.html';
        return false;
      }

      return true;
    }

    let currentUser = null;
    let allUsers = [];
    let allDocuments = [];
    let allMeetingSlots = [];
    let allAdmins = [];

    // èªè¨¼ãƒã‚§ãƒƒã‚¯
    onAuthStateChanged(auth, async (user) => {
      const ok = await requireAdminRoleOrRedirect(user);
      if (!ok) return;

      currentUser = user;
      console.log('âœ… ç®¡ç†è€…èªè¨¼æˆåŠŸ:', user.email);

      document.getElementById('adminName').textContent = user.email || 'ç®¡ç†è€…';
      document.getElementById('adminAvatar').textContent = (user.email || 'A').substring(0, 1).toUpperCase();

      await loadAllData();
    });

    // ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
    async function loadAllData() {
      try {
        console.log('ğŸ“¥ ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿é–‹å§‹...');

        await loadDocuments();
        await loadMeetingSlots();
        await loadAdmins();

        updateStats();
        displayOverview();

        console.log('âœ… ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†');
      } catch (error) {
        console.error('âŒ ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
      }
    }

    // æ›¸é¡ãƒ‡ãƒ¼ã‚¿å–å¾—
    async function loadDocuments() {
      try {
        const q = query(collection(db, 'documents'), orderBy('uploadedAt', 'desc'));
        const snapshot = await getDocs(q);

        allDocuments = [];
        const userIds = new Set();

        snapshot.forEach(d => {
          const data = d.data();
          allDocuments.push({ id: d.id, ...data });
          if (data.userId) userIds.add(data.userId);
        });

        console.log(`ğŸ“„ æ›¸é¡: ${allDocuments.length}ä»¶`);

        await loadUsers(); // ä¿®æ­£: users ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å…¨ä½“ã‚’å–å¾—
        displayDocuments();

      } catch (error) {
        console.error('âŒ æ›¸é¡èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        allDocuments = [];
        displayDocuments();
      }
    }

    // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
    // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—ï¼ˆä¿®æ­£ç‰ˆ: users ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å…¨ä½“ã‚’å–å¾—ï¼‰
    async function loadUsers() {
      try {
        console.log('ğŸ‘¥ ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’èª­ã¿è¾¼ã¿ä¸­...');
        allUsers = [];

        // users ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å…¨ä½“ã‚’å–å¾—
        const usersRef = collection(db, 'users');
        const usersSnapshot = await getDocs(usersRef);

        usersSnapshot.forEach(docSnapshot => {
          const data = docSnapshot.data();
          
          // ç®¡ç†è€…ã‚’é™¤å¤–ï¼ˆrole ãŒ admin ã¾ãŸã¯ superadmin ä»¥å¤–ã‚’è¡¨ç¤ºï¼‰
          if (data.role !== 'admin' && data.role !== 'superadmin') {
            allUsers.push({
              id: docSnapshot.id,
              ...data
            });
          } else {
            console.log(`ğŸ›¡ï¸ ç®¡ç†è€…ã‚’é™¤å¤–: ${data.email || docSnapshot.id} (role: ${data.role})`);
          }
        });

        console.log(`âœ… ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼: ${allUsers.length}äººï¼ˆç®¡ç†è€…ã‚’é™¤ãï¼‰`);

        displayUsers();
        updateUserFilterOptions();

      } catch (error) {
        console.error('âŒ ãƒ¦ãƒ¼ã‚¶ãƒ¼èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        alert('ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
      }
    }
    // çµ±è¨ˆæ›´æ–°
    // çµ±è¨ˆæ›´æ–°ï¼ˆç®¡ç†è€…ã‚’é™¤å¤–ï¼‰
    function updateStats() {
      // ç®¡ç†è€…ä»¥å¤–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
      const regularUsers = allUsers.filter(user => {
        const role = user.role || 'user';
        return role !== 'admin' && role !== 'superadmin';
      });
      
      document.getElementById('totalUsers').textContent = regularUsers.length;
      document.getElementById('totalDocuments').textContent = allDocuments.length;
      document.getElementById('totalMeetings').textContent = allMeetingSlots.length;
      document.getElementById('totalApplications').textContent = '0'; // ä»Šå¾Œå®Ÿè£…
      
      console.log(`ğŸ“Š çµ±è¨ˆæ›´æ–°: ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ ${regularUsers.length}åï¼ˆå…¨${allUsers.length}åä¸­ï¼‰`);
    }

    // æ¦‚è¦ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤º
    function displayOverview() {
      const container = document.getElementById('recentActivity');
      if (!container) return;
      
      const html = `
        <h3 style="margin-bottom: 20px; color: #333;">
          <i class="fas fa-chart-line"></i> ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚µãƒãƒªãƒ¼
        </h3>
        
        <div style="display: grid; gap: 15px;">
          <!-- ä»Šæ—¥ã®æ´»å‹• -->
          <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px; border-radius: 12px; color: white; box-shadow: 0 4px 15px rgba(102,126,234,0.3);">
            <h4 style="margin-bottom: 15px; font-size: 1.1rem;">
              <i class="fas fa-calendar-day"></i> æœ¬æ—¥ã®äºˆå®š
            </h4>
            <div style="display: flex; gap: 30px; flex-wrap: wrap;">
              <div>
                <div style="font-size: 0.9rem; opacity: 0.9;">æœ¬æ—¥ã®é¢è«‡</div>
                <div style="font-size: 2rem; font-weight: 700; margin-top: 5px;" id="todayMeetings">-</div>
              </div>
              <div>
                <div style="font-size: 0.9rem; opacity: 0.9;">æ–°è¦ç™»éŒ²</div>
                <div style="font-size: 2rem; font-weight: 700; margin-top: 5px;" id="todayUsers">-</div>
              </div>
              <div>
                <div style="font-size: 0.9rem; opacity: 0.9;">æ–°è¦æ›¸é¡</div>
                <div style="font-size: 2rem; font-weight: 700; margin-top: 5px;" id="todayDocs">-</div>
              </div>
            </div>
          </div>
          
          <!-- æœ€è¿‘ã®æ›¸é¡ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ -->
          <div style="background: #f8f9fa; padding: 20px; border-radius: 12px;">
            <h4 style="color: #667eea; margin-bottom: 15px; font-size: 1rem;">
              <i class="fas fa-file-upload"></i> æœ€è¿‘ã®æ›¸é¡ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆæœ€æ–°5ä»¶ï¼‰
            </h4>
            <div id="recentDocsList" style="min-height: 100px;">
              <div style="text-align: center; padding: 30px; color: #999;">
                <i class="fas fa-spinner fa-spin" style="font-size: 2rem;"></i>
                <p style="margin-top: 10px;">èª­ã¿è¾¼ã¿ä¸­...</p>
              </div>
            </div>
          </div>
          
          <!-- å¾…æ©Ÿä¸­ã®äºˆç´„ãƒªã‚¯ã‚¨ã‚¹ãƒˆ -->
          <div style="background: #fff3cd; padding: 20px; border-radius: 12px; border-left: 4px solid #f39c12;">
            <h4 style="color: #856404; margin-bottom: 15px; font-size: 1rem;">
              <i class="fas fa-clock"></i> å¾…æ©Ÿä¸­ã®äºˆç´„ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
            </h4>
            <div id="pendingRequests">
              <p style="color: #856404; font-size: 1.5rem; font-weight: 700; margin: 0;">
                <span id="pendingCount">-</span> ä»¶
              </p>
              <p style="color: #999; font-size: 0.9rem; margin-top: 5px;">
                å¯¾å¿œãŒå¿…è¦ãªäºˆç´„ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚ã‚Šã¾ã™
              </p>
            </div>
          </div>
          
          <!-- ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ -->
          <div style="background: #d4edda; padding: 20px; border-radius: 12px; border-left: 4px solid #28a745;">
            <h4 style="color: #155724; margin-bottom: 15px; font-size: 1rem;">
              <i class="fas fa-check-circle"></i> ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹
            </h4>
            <p style="color: #155724; margin: 0;">
              âœ… ã™ã¹ã¦ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™
            </p>
            <p style="color: #6c757d; font-size: 0.85rem; margin-top: 10px;">
              æœ€çµ‚æ›´æ–°: <span id="lastUpdate">-</span>
            </p>
          </div>
        </div>
      `;
      
      container.innerHTML = html;
      
      // ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
      updateOverviewData();
    }
    
    // æ¦‚è¦ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿æ›´æ–°
    function updateOverviewData() {
      // ä»Šæ—¥ã®æ—¥ä»˜ï¼ˆæ—¥æœ¬æ™‚é–“ï¼‰
      const today = new Date();
      const todayStart = new Date(today.getFullYear(), today.getMonth(), today.getDate());
      const todayEnd = new Date(todayStart.getTime() + 24 * 60 * 60 * 1000);
      
      // æœ¬æ—¥ã®é¢è«‡æ•°
      let todayMeetingsCount = 0;
      if (allMeetingSlots && allMeetingSlots.length > 0) {
        todayMeetingsCount = allMeetingSlots.filter(slot => {
          try {
            let slotDate;
            if (slot.datetime) {
              slotDate = slot.datetime.toDate ? slot.datetime.toDate() : new Date(slot.datetime);
            } else if (slot.date) {
              slotDate = new Date(slot.date);
            } else {
              return false;
            }
            return slotDate >= todayStart && slotDate < todayEnd;
          } catch (e) {
            return false;
          }
        }).length;
      }
      document.getElementById('todayMeetings').textContent = todayMeetingsCount;
      
      // æœ¬æ—¥ã®æ–°è¦ç™»éŒ²æ•°
      let todayUsersCount = 0;
      if (allUsers && allUsers.length > 0) {
        todayUsersCount = allUsers.filter(user => {
          if (!user.createdAt) return false;
          try {
            const userDate = user.createdAt.toDate ? user.createdAt.toDate() : new Date(user.createdAt);
            return userDate >= todayStart && userDate < todayEnd;
          } catch (e) {
            return false;
          }
        }).length;
      }
      document.getElementById('todayUsers').textContent = todayUsersCount;
      
      // æœ¬æ—¥ã®æ–°è¦æ›¸é¡æ•°
      let todayDocsCount = 0;
      if (allDocuments && allDocuments.length > 0) {
        todayDocsCount = allDocuments.filter(doc => {
          if (!doc.uploadedAt) return false;
          try {
            const docDate = doc.uploadedAt.toDate ? doc.uploadedAt.toDate() : new Date(doc.uploadedAt);
            return docDate >= todayStart && docDate < todayEnd;
          } catch (e) {
            return false;
          }
        }).length;
      }
      document.getElementById('todayDocs').textContent = todayDocsCount;
      
      // æœ€è¿‘ã®æ›¸é¡ãƒªã‚¹ãƒˆ
      displayRecentDocuments();
      
      // å¾…æ©Ÿä¸­ã®äºˆç´„ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ï¼ˆä»Šå¾Œå®Ÿè£…äºˆå®šï¼‰
      document.getElementById('pendingCount').textContent = '0';
      
      // æœ€çµ‚æ›´æ–°æ™‚åˆ»
      document.getElementById('lastUpdate').textContent = new Date().toLocaleString('ja-JP', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit'
      });
    }
    
    // æœ€è¿‘ã®æ›¸é¡ã‚’è¡¨ç¤º
    function displayRecentDocuments() {
      const container = document.getElementById('recentDocsList');
      if (!container) return;
      
      if (!allDocuments || allDocuments.length === 0) {
        container.innerHTML = `
          <div style="text-align: center; padding: 20px; color: #999;">
            <i class="fas fa-inbox" style="font-size: 2rem; opacity: 0.3;"></i>
            <p style="margin-top: 10px;">ã¾ã æ›¸é¡ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
          </div>
        `;
        return;
      }
      
      const recentDocs = allDocuments.slice(0, 5);
      let html = '';
      
      recentDocs.forEach(docItem => {
        const user = allUsers.find(u => u.id === docItem.userId);
        const userName = user ? (user.displayName || user.email || 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸æ˜') : 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸æ˜';
        const timeAgo = getTimeAgo(docItem.uploadedAt);
        const fileName = docItem.fileName || docItem.name || 'ç„¡é¡Œ';
        
        html += `
          <div style="padding: 12px; background: white; border-radius: 8px; margin-bottom: 10px; display: flex; align-items: center; gap: 12px; border: 1px solid #e0e0e0;">
            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
              <i class="fas fa-file-alt"></i>
            </div>
            <div style="flex: 1; min-width: 0;">
              <div style="font-weight: 600; color: #333; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                ${escapeHtml(userName)}
              </div>
              <div style="color: #666; font-size: 0.9rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                ${escapeHtml(fileName)}
              </div>
              <div style="color: #999; font-size: 0.85rem; margin-top: 2px;">
                ${escapeHtml(timeAgo)}
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // åˆ©ç”¨è€…ä¸€è¦§è¡¨ç¤º
    function displayUsers() {
      const container = document.getElementById('usersTable');

      if (allUsers.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-users"></i>
            <h3>åˆ©ç”¨è€…ãŒã„ã¾ã›ã‚“</h3>
          </div>
        `;
        return;
      }

      let html = `
        <table>
          <thead>
            <tr>
              <th>æ°å</th>
              <th>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</th>
              <th>ç™»éŒ²æ—¥</th>
              <th>æ›¸é¡æ•°</th>
              <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
              <th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
            </tr>
          </thead>
          <tbody>
      `;

      allUsers.forEach(u => {
        const userDocs = allDocuments.filter(d => d.userId === u.id);
        const displayName = u.displayName || u.name || u.email || 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åä¸æ˜';
        const createdAt = u.createdAt ? formatDate(u.createdAt) : '-';

        html += `
          <tr data-user-id="${escapeHtml(u.id)}">
            <td><strong>${escapeHtml(displayName)}</strong></td>
            <td>${escapeHtml(u.email || '-')}</td>
            <td>${escapeHtml(createdAt)}</td>
            <td><span class="badge badge-info">${userDocs.length}ä»¶</span></td>
            <td><span class="badge badge-success">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–</span></td>
            <td>
              <div class="action-btns">
                <button class="btn-action btn-view" onclick="viewUser('${escapeJs(u.id)}')" title="è©³ç´°">
                  <i class="fas fa-eye"></i>
                </button>
                <button class="btn-action btn-edit" onclick="editUser('${escapeJs(u.id)}')" title="ç·¨é›†">
                  <i class="fas fa-edit"></i>
                </button>
              </div>
            </td>
          </tr>
        `;
      });

      html += '</tbody></table>';
      container.innerHTML = html;

      applyUserFilter(); // åˆæœŸé©ç”¨
    }

    // æ›¸é¡ä¸€è¦§è¡¨ç¤º
    function displayDocuments() {
      const container = document.getElementById('documentsTable');

      if (allDocuments.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-folder-open"></i>
            <h3>æ›¸é¡ãŒã‚ã‚Šã¾ã›ã‚“</h3>
          </div>
        `;
        return;
      }

      let html = `
        <table>
          <thead>
            <tr>
              <th>ãƒ•ã‚¡ã‚¤ãƒ«å</th>
              <th>åˆ©ç”¨è€…</th>
              <th>ç¨®é¡</th>
              <th>ã‚µã‚¤ã‚º</th>
              <th>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ—¥</th>
              <th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
            </tr>
          </thead>
          <tbody>
      `;

      allDocuments.forEach(docItem => {
        const user = allUsers.find(u => u.id === docItem.userId);
        const userName = user ? (user.displayName || user.name || user.email) : 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸æ˜';
        const typeName = getDocumentTypeName(docItem.documentType);
        const fileSize = formatFileSize(docItem.fileSize);
        const uploadDate = formatDate(docItem.uploadedAt);

        html += `
          <tr data-doc-user="${escapeHtml(docItem.userId || '')}" data-doc-type="${escapeHtml(docItem.documentType || '')}">
            <td><strong>${escapeHtml(docItem.fileName || '')}</strong></td>
            <td>${escapeHtml(userName || '')}</td>
            <td><span class="badge badge-info">${escapeHtml(typeName)}</span></td>
            <td>${escapeHtml(fileSize)}</td>
            <td>${escapeHtml(uploadDate)}</td>
            <td>
              <div class="action-btns">
                <button class="btn-action btn-view" onclick="downloadDocument('${escapeJs(docItem.downloadURL || '')}')" title="ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰">
                  <i class="fas fa-download"></i>
                </button>
                <button class="btn-action btn-view" onclick="viewDocumentDetails('${escapeJs(docItem.id)}')" title="è©³ç´°">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </td>
          </tr>
        `;
      });

      html += '</tbody></table>';
      container.innerHTML = html;

      applyDocumentFilter(); // åˆæœŸé©ç”¨
    }

    // ===============
    // meetingSlots ç®¡ç†
    // ===============
    async function loadMeetingSlots() {
      try {
        console.log('ğŸ“¥ é¢è«‡æ ã‚’èª­ã¿è¾¼ã¿ä¸­...');
        const q = query(collection(db, 'meetingSlots'), orderBy('datetime', 'asc'));
        const snapshot = await getDocs(q);

        allMeetingSlots = [];
        snapshot.forEach(d => {
          allMeetingSlots.push({ id: d.id, ...d.data() });
        });

        console.log(`ğŸ—“ é¢è«‡æ : ${allMeetingSlots.length}ä»¶`);
        displayMeetingSlots();

      } catch (error) {
        console.error('âŒ é¢è«‡æ èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        allMeetingSlots = [];
        displayMeetingSlots();
      }
    }

    function displayMeetingSlots() {
      const container = document.getElementById('meetingSlotsContainer');
      if (!container) return;

      if (!allMeetingSlots || allMeetingSlots.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-calendar-times"></i>
            <h3>é¢è«‡æ ãŒã‚ã‚Šã¾ã›ã‚“</h3>
            <p style="color:#999;">å³ä¸Šã®ã€Œé¢è«‡æ ã‚’è¿½åŠ ã€ã‹ã‚‰ä½œæˆã§ãã¾ã™ã€‚</p>
          </div>
        `;
        return;
      }

      // æ—¥ä»˜ã§ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°
      const groups = {};
      allMeetingSlots.forEach(slot => {
        const d = slot.date || formatDateForKey(slot.datetime);
        if (!groups[d]) groups[d] = [];
        groups[d].push(slot);
      });

      const dates = Object.keys(groups).sort();
      let html = '';

      dates.forEach(dateKey => {
        html += `<div class="meeting-day-group">`;
        html += `
          <div class="meeting-day-header">
            <div><i class="fas fa-calendar-day"></i> ${escapeHtml(dateKey)}</div>
            <div style="color:#666;font-weight:600;">${groups[dateKey].length}ä»¶</div>
          </div>
        `;

        groups[dateKey].forEach(slot => {
          const startTime = slot.startTime || '';
          const endTime = slot.endTime || '';
          const type = slot.type || 'æœªè¨­å®š';
          const location = slot.location || 'æœªè¨­å®š';
          const maxCapacity = Number(slot.maxCapacity ?? slot.capacity ?? 1);
          const currentBookings = Number(slot.currentBookings ?? 0);

          const isBooked = currentBookings >= maxCapacity;
          const statusBadge = isBooked
            ? `<span class="status-badge booked">äºˆç´„æ¸ˆ</span>`
            : `<span class="status-badge available">ç©ºã</span>`;

          const canDelete = currentBookings <= 0;

          html += `
            <div class="meeting-slot-card">
              <div class="slot-left">
                <div class="slot-time">${escapeHtml(startTime)} - ${escapeHtml(endTime)}</div>
                <div class="slot-meta">
                  <span><i class="fas fa-comments"></i> ${escapeHtml(type)}</span>
                  &nbsp;|&nbsp;
                  <span><i class="fas fa-map-marker-alt"></i> ${escapeHtml(location)}</span>
                  ${slot.meetingLink ? `<br><small><i class="fas fa-link"></i> ${escapeHtml(slot.meetingLink)}</small>` : ''}
                </div>
              </div>
              <div class="slot-right">
                ${statusBadge}
                <span class="capacity-badge">${currentBookings}/${maxCapacity}</span>
                <button class="btn-action btn-edit" onclick="showEditSlotModal('${escapeJs(slot.id)}')" title="ç·¨é›†">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="btn-action btn-delete" onclick="showDeleteSlotModal('${escapeJs(slot.id)}')" title="${canDelete ? 'å‰Šé™¤' : 'äºˆç´„æ¸ˆã¿ã®ãŸã‚å‰Šé™¤ä¸å¯'}" ${canDelete ? '' : 'disabled'}>
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </div>
          `;
        });

        html += `</div>`;
      });

      container.innerHTML = html;

      applyMeetingFilter(); // åˆæœŸé©ç”¨
    }

    function generateHourlySlots(date, startTime, endTime, type, location, meetingLink, capacity, userId) {
      const slots = [];
      const start = new Date(`${date}T${startTime}:00`);
      const end = new Date(`${date}T${endTime}:00`);
      const HOUR_MS = 60 * 60 * 1000;

      let current = new Date(start);
      while (current < end) {
        const next = new Date(current.getTime() + HOUR_MS);
        if (next > end) break;

        const slotStartTime = toHHMM(current);
        const slotEndTime = toHHMM(next);

        slots.push({
          date: date,
          startTime: slotStartTime,
          endTime: slotEndTime,
          datetime: Timestamp.fromDate(current),
          type: type,
          location: location,
          meetingLink: meetingLink || '',
          maxCapacity: Number(capacity || 1),
          currentBookings: 0,
          status: 'available',
          createdBy: userId,
          createdAt: serverTimestamp()
        });

        current = next;
      }
      return slots;
    }

    // é¢è«‡æ è¿½åŠ 
    function showAddSlotModal() {
      window.showAddSlotModal = showAddSlotModal;
      const modal = document.getElementById('addSlotModal');
      if (!modal) return;

      // ä»Šæ—¥ / 10:00-11:00 ã‚’åˆæœŸå€¤
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2, '0');
      const dd = String(today.getDate()).padStart(2, '0');
      document.getElementById('slotDate').value = `${yyyy}-${mm}-${dd}`;
      document.getElementById('slotStartTime').value = '10:00';
      document.getElementById('slotEndTime').value = '11:00';
      document.getElementById('slotCapacity').value = '1';

      modal.classList.add('show');
    }
    window.closeAddSlotModal = closeAddSlotModal;
    function closeAddSlotModal(){ document.getElementById('addSlotModal')?.classList.remove('show'); }

    document.getElementById('addSlotForm')?.addEventListener('submit', async (e) => {
      e.preventDefault();
      if (!currentUser) return;

      const date = document.getElementById('slotDate').value;
      const startTime = document.getElementById('slotStartTime').value;
      const endTime = document.getElementById('slotEndTime').value;
      const type = document.getElementById('slotType').value;
      const location = document.getElementById('slotLocation').value;
      const meetingLink = document.getElementById('slotMeetingLink').value;
      const capacity = Number(document.getElementById('slotCapacity').value || 1);

      if (!date || !startTime || !endTime) {
        alert('å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      // è‡ªå‹•åˆ†å‰²
      const slots = generateHourlySlots(date, startTime, endTime, type, location, meetingLink, capacity, currentUser.uid);
      if (slots.length === 0) {
        alert('æ™‚é–“ç¯„å›²ãŒä¸æ­£ã§ã™ï¼ˆ1æ™‚é–“å˜ä½ã§ä½œæˆã§ãã¾ã›ã‚“ï¼‰');
        return;
      }

      // é‡è¤‡ãƒã‚§ãƒƒã‚¯ï¼ˆåŒä¸€æ—¥ãƒ»åŒä¸€é–‹å§‹/çµ‚äº†ï¼‰
      const existingKeySet = new Set(
        (allMeetingSlots || []).map(s => `${s.date || ''}_${s.startTime || ''}_${s.endTime || ''}`)
      );

      let created = 0;
      let skipped = 0;

      try {
        for (const s of slots) {
          const key = `${s.date}_${s.startTime}_${s.endTime}`;
          if (existingKeySet.has(key)) {
            skipped++;
            continue;
          }
          await addDoc(collection(db, 'meetingSlots'), s);
          created++;
          existingKeySet.add(key);
        }

        alert(`âœ… é¢è«‡æ ã‚’è¿½åŠ ã—ã¾ã—ãŸ\nè¿½åŠ : ${created}ä»¶ / é‡è¤‡ã‚¹ã‚­ãƒƒãƒ—: ${skipped}ä»¶`);
        closeAddSlotModal();
        await loadMeetingSlots();
        updateStats();

      } catch (error) {
        console.error('âŒ é¢è«‡æ è¿½åŠ ã‚¨ãƒ©ãƒ¼:', error);
        alert('é¢è«‡æ ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
      }
    });

    function showEditSlotModal(slotId) {
      const slot = allMeetingSlots.find(s => s.id === slotId);
      if (!slot) return;

      document.getElementById('editSlotId').value = slotId;
      document.getElementById('editSlotDate').value = slot.date || formatDateForKey(slot.datetime);
      document.getElementById('editSlotTime').value = `${slot.startTime || ''} - ${slot.endTime || ''}`;
      document.getElementById('editSlotType').value = slot.type || 'åˆå›ã‚­ãƒ£ãƒªã‚¢é¢è«‡';
      document.getElementById('editSlotLocation').value = slot.location || 'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼ˆZoomï¼‰';
      document.getElementById('editSlotMeetingLink').value = slot.meetingLink || '';

      document.getElementById('editSlotModal').classList.add('show');
    }
    function closeEditSlotModal(){ document.getElementById('editSlotModal')?.classList.remove('show'); }

    document.getElementById('editSlotForm')?.addEventListener('submit', async (e) => {
      e.preventDefault();
      if (!currentUser) return;

      const slotId = document.getElementById('editSlotId').value;
      const type = document.getElementById('editSlotType').value;
      const location = document.getElementById('editSlotLocation').value;
      const meetingLink = document.getElementById('editSlotMeetingLink').value;

      try {
        await updateDoc(doc(db, 'meetingSlots', slotId), {
          type,
          location,
          meetingLink: meetingLink || '',
          updatedAt: serverTimestamp(),
          updatedBy: currentUser.uid
        });
        alert('âœ… é¢è«‡æ ã‚’æ›´æ–°ã—ã¾ã—ãŸ');
        closeEditSlotModal();
        await loadMeetingSlots();

      } catch (error) {
        console.error('âŒ é¢è«‡æ æ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
        alert('é¢è«‡æ ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
      }
    });

    function showDeleteSlotModal(slotId) {
      const slot = allMeetingSlots.find(s => s.id === slotId);
      if (!slot) return;

      const currentBookings = Number(slot.currentBookings ?? 0);
      if (currentBookings > 0) {
        alert('âš ï¸ äºˆç´„ãŒå…¥ã£ã¦ã„ã‚‹é¢è«‡æ ã¯å‰Šé™¤ã§ãã¾ã›ã‚“');
        return;
      }

      const ok = confirm(`é¢è«‡æ ã‚’å‰Šé™¤ã—ã¾ã™ã€‚\n${slot.date || ''} ${slot.startTime || ''}-${slot.endTime || ''}\nã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ`);
      if (!ok) return;

      confirmDeleteSlot(slotId);
    }

    async function confirmDeleteSlot(slotId) {
      try {
        await deleteDoc(doc(db, 'meetingSlots', slotId));
        alert('âœ… é¢è«‡æ ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
        await loadMeetingSlots();
        updateStats();
      } catch (error) {
        console.error('âŒ é¢è«‡æ å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
        alert('é¢è«‡æ ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
      }
    }

    // ===============
    // admins ç®¡ç†ï¼ˆAæ¡ˆï¼šãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‰Šé™¤ï¼‰
    // ===============
    async function loadAdmins() {
      try {
        console.log('ğŸ“¥ ç®¡ç†è€…ä¸€è¦§ã‚’èª­ã¿è¾¼ã¿ä¸­...');
        const q = query(collection(db, 'admins'), orderBy('createdAt', 'desc'));
        const snapshot = await getDocs(q);

        allAdmins = [];
        snapshot.forEach(d => {
          allAdmins.push({ id: d.id, ...d.data() });
        });

        console.log(`âœ… ç®¡ç†è€…: ${allAdmins.length}äºº`);
        displayAdmins();

      } catch (error) {
        console.error('âŒ ç®¡ç†è€…èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        // Aæ¡ˆï¼šãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã—ãªã„
        const container = document.getElementById('adminsTable');
        if (container) {
          const msg = (error?.code === 'permission-denied')
            ? 'æ¨©é™ãŒä¸è¶³ã—ã¦ã„ã‚‹ãŸã‚ã€ç®¡ç†è€…ä¸€è¦§ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ï¼ˆFirestore ãƒ«ãƒ¼ãƒ«ã‚’ã”ç¢ºèªãã ã•ã„ï¼‰ã€‚'
            : 'ç®¡ç†è€…ä¸€è¦§ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚';
          container.innerHTML = `
            <div style="background:#ffebee; padding: 15px; border-radius: 8px; border-left: 4px solid #c62828;">
              <p style="margin:0; color:#c62828; font-weight:800;">
                <i class="fas fa-triangle-exclamation"></i> ${escapeHtml(msg)}
              </p>
              <p style="margin-top:8px; color:#666; font-size:0.9rem;">
                ã‚¨ãƒ©ãƒ¼: ${escapeHtml(error?.message || 'unknown')}
              </p>
            </div>
          `;
        }
      }
    }

    function displayAdmins() {
      const container = document.getElementById('adminsTable');
      if (!container) return;

      if (!allAdmins || allAdmins.length === 0) {
        // Aæ¡ˆï¼šãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã«é€ƒã’ãªã„
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-user-shield"></i>
            <h3>ç®¡ç†è€…ãŒæœªç™»éŒ²ã§ã™</h3>
            <p style="color:#999;">ã€Œç®¡ç†è€…ã‚’è¿½åŠ ã€ã‹ã‚‰ admins ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«ç™»éŒ²ã—ã¦ãã ã•ã„ã€‚</p>
          </div>
        `;
        return;
      }

      let html = `
        <table>
          <thead>
            <tr>
              <th>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</th>
              <th>æ¨©é™ãƒ¬ãƒ™ãƒ«</th>
              <th>ç™»éŒ²æ—¥</th>
              <th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
            </tr>
          </thead>
          <tbody>
      `;

      allAdmins.forEach(admin => {
        const roleName = getRoleName(admin.role);
        const roleClass = getRoleClass(admin.role);
        const createdAt = admin.createdAt ? formatDate(admin.createdAt) : '-';
        const isSelf = admin.email === currentUser?.email;

        html += `
          <tr>
            <td>
              <strong>${escapeHtml(admin.email || '')}</strong>
              ${isSelf ? '<span class="badge badge-info" style="margin-left: 10px;">è‡ªåˆ†</span>' : ''}
            </td>
            <td><span class="role-badge ${roleClass}">${escapeHtml(roleName)}</span></td>
            <td>${escapeHtml(createdAt)}</td>
            <td>
              <div class="action-btns">
                ${!isSelf ? `
                  <button class="btn-action btn-edit" onclick="showEditAdminModal('${escapeJs(admin.id)}')" title="ç·¨é›†">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="btn-action btn-delete" onclick="showDeleteAdminModal('${escapeJs(admin.id)}')" title="å‰Šé™¤">
                    <i class="fas fa-trash"></i>
                  </button>
                ` : `
                  <span style="color:#999; font-size:0.85rem;">-</span>
                `}
              </div>
            </td>
          </tr>
        `;
      });

      html += '</tbody></table>';
      container.innerHTML = html;
    }

    function showAddAdminModal(){ document.getElementById('addAdminModal')?.classList.add('show'); }
    function closeAddAdminModal(){ document.getElementById('addAdminModal')?.classList.remove('show'); }

    document.getElementById('addAdminForm')?.addEventListener('submit', async (e) => {
      e.preventDefault();
      if (!currentUser) return;

      const email = document.getElementById('adminEmail').value.trim();
      const role = document.getElementById('adminRole').value;

      if (!email) { alert('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }

      try {
        const adminData = {
          email,
          role,
          createdAt: new Date(),
          createdBy: currentUser.uid
        };
        await addDoc(collection(db, 'admins'), adminData);

        alert('âœ… ç®¡ç†è€…ã‚’è¿½åŠ ã—ã¾ã—ãŸ\n\næ³¨æ„: å¿…è¦ã«å¿œã˜ã¦ Firebase Authentication ã§ã‚‚è©²å½“ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆã‚’ã”æ¤œè¨ãã ã•ã„ã€‚');
        closeAddAdminModal();
        await loadAdmins();

      } catch (error) {
        console.error('âŒ ç®¡ç†è€…è¿½åŠ ã‚¨ãƒ©ãƒ¼:', error);
        alert('ç®¡ç†è€…ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
      }
    });

    // ç®¡ç†è€…ç·¨é›†
    function showEditAdminModal(adminId) {
      const admin = allAdmins.find(a => a.id === adminId);
      if (!admin) return;

      document.getElementById('editAdminId').value = adminId;
      document.getElementById('editAdminEmail').value = admin.email || '';
      document.getElementById('editAdminRole').value = admin.role || 'admin';

      document.getElementById('editAdminModal').classList.add('show');
    }
    function closeEditAdminModal(){ document.getElementById('editAdminModal')?.classList.remove('show'); }

    document.getElementById('editAdminForm')?.addEventListener('submit', async (e) => {
      e.preventDefault();
      if (!currentUser) return;

      const adminId = document.getElementById('editAdminId').value;
      const role = document.getElementById('editAdminRole').value;

      try {
        await updateDoc(doc(db, 'admins', adminId), {
          role: role,
          updatedAt: new Date(),
          updatedBy: currentUser.uid
        });

        alert('âœ… ç®¡ç†è€…æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ');
        closeEditAdminModal();
        await loadAdmins();

      } catch (error) {
        console.error('âŒ ç®¡ç†è€…æ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
        alert('ç®¡ç†è€…æƒ…å ±ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
      }
    });

    // ç®¡ç†è€…å‰Šé™¤
    function showDeleteAdminModal(adminId) {
      const admin = allAdmins.find(a => a.id === adminId);
      if (!admin) return;

      if (admin.email === currentUser?.email) {
        alert('âš ï¸ è‡ªåˆ†è‡ªèº«ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“');
        return;
      }

      document.getElementById('deleteAdminId').value = adminId;
      document.getElementById('deleteAdminEmail').textContent = admin.email || '-';
      document.getElementById('deleteAdminModal').classList.add('show');
    }
    function closeDeleteAdminModal(){ document.getElementById('deleteAdminModal')?.classList.remove('show'); }

    async function confirmDeleteAdmin() {
      const adminId = document.getElementById('deleteAdminId').value;

      try {
        await deleteDoc(doc(db, 'admins', adminId));
        alert('âœ… ç®¡ç†è€…ã‚’å‰Šé™¤ã—ã¾ã—ãŸ\n\næ³¨æ„: Firebase Authentication ã‹ã‚‰ã‚‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚');
        closeDeleteAdminModal();
        await loadAdmins();

      } catch (error) {
        console.error('âŒ ç®¡ç†è€…å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
        alert('ç®¡ç†è€…ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
      }
    }

    // ===============
    // UIæ“ä½œ
    // ===============
    function showSection(sectionName) {
      // ã‚µã‚¤ãƒ‰ãƒãƒ¼ active
      document.querySelectorAll('.sidebar-menu a').forEach(a => a.classList.remove('active'));
      const activeLink = Array.from(document.querySelectorAll('.sidebar-menu a'))
        .find(a => (a.getAttribute('onclick') || '').includes(`'${sectionName}'`));
      if (activeLink) activeLink.classList.add('active');

      // ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ‡æ›¿
      document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
      document.getElementById(`section-${sectionName}`)?.classList.add('active');

      if (sectionName === 'settings') {
        // settings è¡¨ç¤ºæ™‚ã« admins ã‚’ãƒ­ãƒ¼ãƒ‰
        loadAdmins();
      }
    }
    window.showSection = showSection;

    function showSettingsTab(tabName){
      document.querySelectorAll('.settings-tab').forEach(b => b.classList.remove('active'));
      if (tabName === 'admins') {
        document.querySelectorAll('.settings-tab')[0]?.classList.add('active');
        document.getElementById('settings-admins').style.display = '';
        document.getElementById('settings-system').style.display = 'none';
        loadAdmins();
      } else {
        document.querySelectorAll('.settings-tab')[1]?.classList.add('active');
        document.getElementById('settings-admins').style.display = 'none';
        document.getElementById('settings-system').style.display = '';
      }
    }
    window.showSettingsTab = showSettingsTab;

    // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
    async function logout() {
      const ok = confirm('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã™ã‹ï¼Ÿ');
      if (!ok) return;

      try {
        console.log('ğŸ”“ ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç†é–‹å§‹...');
        if (!auth) {
          console.error('âŒ auth ãŒæœªå®šç¾©ã§ã™');
          alert('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ');
          return;
        }
        await signOut(auth);
        console.log('âœ… ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæˆåŠŸ');
        window.location.href = 'log-in.html';
      } catch (e) {
        console.error('âŒ ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã‚¨ãƒ©ãƒ¼:', e);
        alert('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    }
    window.logout = logout;

    // ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆç°¡æ˜“ï¼‰
    function applyUserFilter(){
      const q = (document.getElementById('userSearch')?.value || '').toLowerCase();
      const status = document.getElementById('userStatusFilter')?.value || 'all';

      document.querySelectorAll('#usersTable tbody tr').forEach(tr => {
        const text = tr.innerText.toLowerCase();
        const matchText = !q || text.includes(q);
        const matchStatus = (status === 'all') ? true : true; // TODO: statusé€£å‹•
        tr.style.display = (matchText && matchStatus) ? '' : 'none';
      });
    }
    window.applyUserFilter = applyUserFilter;

    function applyDocumentFilter(){
      const userId = document.getElementById('documentUserFilter')?.value || '';
      const type = document.getElementById('documentTypeFilter')?.value || '';

      document.querySelectorAll('#documentsTable tbody tr').forEach(tr => {
        const u = tr.getAttribute('data-doc-user') || '';
        const t = tr.getAttribute('data-doc-type') || '';
        const okU = !userId || userId === u;
        const okT = !type || type === t;
        tr.style.display = (okU && okT) ? '' : 'none';
      });
    }
    window.applyDocumentFilter = applyDocumentFilter;

    function applyMeetingFilter(){
      const dateFilter = document.getElementById('meetingDateFilter')?.value || 'upcoming';
      const statusFilter = document.getElementById('meetingStatusFilter')?.value || 'all';
      
      console.log(`ğŸ” ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨: æ—¥ä»˜=${dateFilter}, ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹=${statusFilter}`);
      
      // Get all meeting slot cards
      const allCards = document.querySelectorAll('.meeting-day-group');
      
      // Get today's date in Japan timezone
      const now = new Date();
      const japanTime = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Tokyo' }));
      const today = new Date(japanTime.getFullYear(), japanTime.getMonth(), japanTime.getDate());
      const todayEnd = new Date(today);
      todayEnd.setHours(23, 59, 59, 999);
      
      const weekEnd = new Date(today);
      weekEnd.setDate(today.getDate() + 7);
      
      const monthEnd = new Date(today);
      monthEnd.setMonth(today.getMonth() + 1);
      
      let visibleCount = 0;
      
      allCards.forEach(dayGroup => {
        const dateHeader = dayGroup.querySelector('.meeting-day-header');
        if (!dateHeader) return;
        
        const dateText = dateHeader.textContent.match(/\d{4}-\d{2}-\d{2}/)?.[0];
        if (!dateText) return;
        
        const groupDate = new Date(dateText + 'T00:00:00');
        
        // Apply date filter
        let passDateFilter = false;
        if (dateFilter === 'all') {
          passDateFilter = true;
        } else if (dateFilter === 'upcoming') {
          passDateFilter = groupDate >= today;
        } else if (dateFilter === 'today') {
          passDateFilter = groupDate >= today && groupDate <= todayEnd;
        } else if (dateFilter === 'week') {
          passDateFilter = groupDate >= today && groupDate < weekEnd;
        } else if (dateFilter === 'month') {
          passDateFilter = groupDate >= today && groupDate < monthEnd;
        }
        
        if (!passDateFilter) {
          dayGroup.style.display = 'none';
          return;
        }
        
        // Apply status filter to individual slots
        const slotCards = dayGroup.querySelectorAll('.meeting-slot-card');
        let visibleSlotsInGroup = 0;
        
        slotCards.forEach(card => {
          const capacityBadge = card.querySelector('.capacity-badge');
          if (!capacityBadge) return;
          
          const capacityText = capacityBadge.textContent.trim();
          const match = capacityText.match(/(\d+)\/(\d+)/);
          if (!match) return;
          
          const currentBookings = parseInt(match[1]);
          const maxCapacity = parseInt(match[2]);
          const isBooked = currentBookings >= maxCapacity;
          
          let passStatusFilter = false;
          if (statusFilter === 'all') {
            passStatusFilter = true;
          } else if (statusFilter === 'available') {
            passStatusFilter = !isBooked;
          } else if (statusFilter === 'booked') {
            passStatusFilter = isBooked;
          }
          
          if (passStatusFilter) {
            card.style.display = '';
            visibleSlotsInGroup++;
          } else {
            card.style.display = 'none';
          }
        });
        
        // Hide the entire day group if no slots are visible
        if (visibleSlotsInGroup > 0) {
          dayGroup.style.display = '';
          visibleCount += visibleSlotsInGroup;
          
          // Update the count in the header
          const countElement = dateHeader.querySelector('div:last-child');
          if (countElement) {
            countElement.textContent = `${visibleSlotsInGroup}ä»¶`;
          }
        } else {
          dayGroup.style.display = 'none';
        }
      });
      
      console.log(`ğŸ” ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼çµæœ: ${visibleCount}ä»¶ã®é¢è«‡æ ã‚’è¡¨ç¤º`);
      
      // Show empty state if no meetings match
      const container = document.getElementById('meetingSlotsContainer');
      if (container && visibleCount === 0) {
        const hasCards = allCards.length > 0;
        if (hasCards) {
          // Add a temporary message
          let existingMsg = container.querySelector('.filter-empty-message');
          if (!existingMsg) {
            existingMsg = document.createElement('div');
            existingMsg.className = 'filter-empty-message';
            existingMsg.style.cssText = 'text-align:center;padding:40px;color:#999;';
            existingMsg.innerHTML = '<i class="fas fa-filter" style="font-size:2rem;opacity:0.3;"></i><p style="margin-top:10px;">é¸æŠã—ãŸæ¡ä»¶ã«ä¸€è‡´ã™ã‚‹é¢è«‡æ ãŒã‚ã‚Šã¾ã›ã‚“</p>';
            container.appendChild(existingMsg);
          }
          existingMsg.style.display = 'block';
        }
      } else {
        // Remove empty message if it exists
        const existingMsg = container?.querySelector('.filter-empty-message');
        if (existingMsg) {
          existingMsg.style.display = 'none';
        }
      }
    }
    window.applyMeetingFilter = applyMeetingFilter;

    // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
    function downloadDocument(url){
      if (!url) { alert('ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰URLãŒã‚ã‚Šã¾ã›ã‚“'); return; }
      window.open(url, '_blank');
    }
    window.downloadDocument = downloadDocument;

    function viewDocumentDetails(id){
      alert('æ›¸é¡è©³ç´°ã¯ä»Šå¾Œå®Ÿè£…äºˆå®šã§ã™ï¼ˆID: ' + id + 'ï¼‰');
    }
    window.viewDocumentDetails = viewDocumentDetails;

    function viewUser(id){
      alert('åˆ©ç”¨è€…è©³ç´°ã¯ä»Šå¾Œå®Ÿè£…äºˆå®šã§ã™ï¼ˆID: ' + id + 'ï¼‰');
    }
    window.viewUser = viewUser;

    function editUser(id){
      alert('åˆ©ç”¨è€…ç·¨é›†ã¯ä»Šå¾Œå®Ÿè£…äºˆå®šã§ã™ï¼ˆID: ' + id + 'ï¼‰');
    }
    window.editUser = editUser;

    // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
    function getDocumentTypeName(type){
      const types = {
        resume: 'å±¥æ­´æ›¸',
        cv: 'è·å‹™çµŒæ­´æ›¸',
        cover_letter: 'ã‚«ãƒãƒ¼ãƒ¬ã‚¿ãƒ¼',
        certificate: 'è³‡æ ¼è¨¼æ˜æ›¸',
        portfolio: 'ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª',
        other: 'ãã®ä»–'
      };
      return types[type] || 'ãã®ä»–';
    }

    function formatFileSize(bytes){
      if (!bytes && bytes !== 0) return '-';
      const b = Number(bytes);
      if (b < 1024) return b + ' B';
      if (b < 1024 * 1024) return (b / 1024).toFixed(1) + ' KB';
      return (b / (1024 * 1024)).toFixed(1) + ' MB';
    }

    function formatDate(timestamp){
      if (!timestamp) return '-';
      const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
      return date.toLocaleDateString('ja-JP', { year:'numeric', month:'2-digit', day:'2-digit' });
    }

    function getTimeAgo(timestamp){
      if (!timestamp) return '-';
      const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
      const now = new Date();
      const diff = now - date;
      const minutes = Math.floor(diff / 60000);
      if (minutes < 60) return `${minutes}åˆ†å‰`;
      const hours = Math.floor(minutes / 60);
      if (hours < 24) return `${hours}æ™‚é–“å‰`;
      const days = Math.floor(hours / 24);
      return `${days}æ—¥å‰`;
    }

    function updateUserFilterOptions(){
      const select = document.getElementById('documentUserFilter');
      if (!select) return;

      let html = '<option value="">ã™ã¹ã¦ã®åˆ©ç”¨è€…</option>';
      allUsers.forEach(u => {
        const name = u.displayName || u.name || u.email || 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸æ˜';
        html += `<option value="${escapeHtml(u.id)}">${escapeHtml(name)}</option>`;
      });
      select.innerHTML = html;
    }

    function getRoleName(role){
      const map = {
        super_admin: 'ã‚¹ãƒ¼ãƒ‘ãƒ¼ç®¡ç†è€…',
        admin: 'ä¸€èˆ¬ç®¡ç†è€…',
        document_admin: 'æ›¸é¡ç®¡ç†è€…',
        meeting_admin: 'é¢è«‡ç®¡ç†è€…'
      };
      return map[role] || 'æœªè¨­å®š';
    }
    function getRoleClass(role){
      const map = {
        super_admin: 'role-super',
        admin: 'role-admin',
        document_admin: 'role-document',
        meeting_admin: 'role-meeting'
      };
      return map[role] || 'role-unknown';
    }

    function toHHMM(date){
      const hh = String(date.getHours()).padStart(2,'0');
      const mm = String(date.getMinutes()).padStart(2,'0');
      return `${hh}:${mm}`;
    }

    function formatDateForKey(datetime){
      if (!datetime) return '';
      const d = datetime.toDate ? datetime.toDate() : new Date(datetime);
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,'0');
      const day = String(d.getDate()).padStart(2,'0');
      return `${y}-${m}-${day}`;
    }

    function escapeHtml(str){
      return String(str ?? '')
        .replaceAll('&', '&amp;')
        .replaceAll('<', '&lt;')
        .replaceAll('>', '&gt;')
        .replaceAll('"', '&quot;')
        .replaceAll("'", '&#039;');
    }
    function escapeJs(str){
      return String(str ?? '').replaceAll('\\', '\\\\').replaceAll("'", "\\'");
    }
    // ============================================================
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†å¾Œã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ç¢ºå®Ÿã«æ¶ˆã™
    // ============================================================
    window.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        // å…¨ã¦ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´ ã‚’æ¶ˆã™
      const loadingSelectors = [
          '.loading',
          '.spinner',
          '[class*="loading"]',
          '[id*="loading"]',
          '[id*="spinner"]',
          '.fa-spinner',
          '.fa-circle-notch'
        ];
    
        loadingSelectors.forEach(selector => {
          document.querySelectorAll(selector).forEach(el => {
            el.style.display = 'none';
            el.style.visibility = 'hidden';
          });
        });
    
        console.log('âœ… ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’å¼·åˆ¶çš„ã«æ¶ˆã—ã¾ã—ãŸ');
      }, 3000); // 3ç§’å¾Œã«å®Ÿè¡Œï¼ˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†ã‚’å¾…ã¤ï¼‰
    });
  </script>
</body>
</html>
