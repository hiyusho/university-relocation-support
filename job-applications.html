<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿œå‹Ÿç®¡ç† - å¤§å­¦èµ´ä»»è€…å®¶æ—å¸¯åŒæ”¯æ´ãƒ—ãƒ­ã‚°ãƒ©ãƒ </title>
    <meta name="description" content="å¿œå‹Ÿã—ãŸæ±‚äººã®ç®¡ç†ã¨é€²æ—ç¢ºèªãŒã§ãã¾ã™ã€‚">
    <link rel="canonical" href="https://hiyusho.github.io/university-relocation-support/job-applications.html">
    
    <!-- Open Graph -->
    <meta property="og:title" content="å¿œå‹Ÿç®¡ç† - å¤§å­¦èµ´ä»»è€…å®¶æ—å¸¯åŒæ”¯æ´ãƒ—ãƒ­ã‚°ãƒ©ãƒ ">
    <meta property="og:description" content="å¿œå‹Ÿã—ãŸæ±‚äººã®ç®¡ç†ã¨é€²æ—ç¢ºèª">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hiyusho.github.io/university-relocation-support/job-applications.html">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            background: white;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            padding: 8px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background: #f0f4ff;
        }

        .header h1 {
            font-size: 24px;
            color: #2d3748;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        /* Filter Tabs */
        .filter-tabs {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 10px 20px;
            border: 2px solid #e2e8f0;
            background: white;
            color: #64748b;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
        }

        /* Stats */
        .stats {
            background: white;
            padding: 20px 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .stats-text {
            font-size: 15px;
            color: #64748b;
        }

        .stats-count {
            font-weight: 700;
            color: #667eea;
        }

        /* Application List */
        .application-list {
            display: grid;
            gap: 20px;
        }

        .application-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .application-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            gap: 15px;
        }

        .card-info {
            flex: 1;
        }

        .job-title {
            font-size: 18px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .company-name {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 10px;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }

        .status-applied {
            background: #dbeafe;
            color: #1e40af;
        }

        .status-screening {
            background: #fef3c7;
            color: #92400e;
        }

        .status-interview {
            background: #e0e7ff;
            color: #4338ca;
        }

        .status-offered {
            background: #d1fae5;
            color: #065f46;
        }

        .status-rejected {
            background: #fee2e2;
            color: #991b1b;
        }

        .card-details {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 10px;
            flex-wrap: wrap;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #64748b;
        }

        .detail-icon {
            color: #667eea;
        }

        .timeline {
            margin-bottom: 15px;
        }

        .timeline-title {
            font-size: 13px;
            font-weight: 600;
            color: #64748b;
            margin-bottom: 10px;
        }

        .timeline-items {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .timeline-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            color: #64748b;
        }

        .timeline-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #cbd5e1;
        }

        .timeline-dot.active {
            background: #667eea;
        }

        .card-footer {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 13px;
        }

        .btn-outline {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn-outline:hover {
            background: #667eea;
            color: white;
        }

        /* Empty State */
        .empty-state {
            background: white;
            padding: 60px 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
        }

        .empty-icon {
            font-size: 80px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .empty-state h2 {
            font-size: 24px;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .empty-state p {
            color: #64748b;
            margin-bottom: 25px;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 60px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Alert */
        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s ease;
        }

        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #10b981;
        }

        .alert-error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #ef4444;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            animation: slideUp 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            margin-bottom: 20px;
        }

        .modal-header h3 {
            font-size: 20px;
            color: #2d3748;
        }

        .modal-body {
            margin-bottom: 25px;
            color: #64748b;
            line-height: 1.6;
        }

        .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
            }

            .header h1 {
                font-size: 20px;
            }

            .card-header {
                flex-direction: column;
            }

            .card-details {
                flex-direction: column;
                gap: 10px;
            }

            .card-footer {
                flex-direction: column;
            }

            .btn-small {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <a href="dashboard.html" class="back-link">
                    â† ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
                </a>
                <h1>ğŸ“‹ å¿œå‹Ÿç®¡ç†</h1>
            </div>
            <a href="job-list.html" class="btn btn-primary">
                ğŸ” æ±‚äººã‚’æ¢ã™
            </a>
        </div>

        <!-- Alert Container -->
        <div id="alertContainer"></div>

        <!-- Filter Tabs -->
        <div class="filter-tabs">
            <div class="tabs">
                <button class="tab active" data-status="all">ã™ã¹ã¦</button>
                <button class="tab" data-status="applied">å¿œå‹Ÿæ¸ˆã¿</button>
                <button class="tab" data-status="screening">æ›¸é¡é¸è€ƒä¸­</button>
                <button class="tab" data-status="interview">é¢æ¥</button>
                <button class="tab" data-status="offered">å†…å®š</button>
                <button class="tab" data-status="rejected">ä¸æ¡ç”¨</button>
            </div>
        </div>

        <!-- Stats -->
        <div id="stats" class="stats" style="display: none;">
            <span class="stats-text">
                <span class="stats-count" id="applicationCount">0</span> ä»¶ã®å¿œå‹ŸãŒã‚ã‚Šã¾ã™
            </span>
        </div>

        <!-- Loading -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>

        <!-- Application List -->
        <div id="applicationList" class="application-list" style="display: none;"></div>

        <!-- Empty State -->
        <div id="emptyState" class="empty-state" style="display: none;">
            <div class="empty-icon">ğŸ“­</div>
            <h2>å¿œå‹ŸãŒã‚ã‚Šã¾ã›ã‚“</h2>
            <p>ã¾ã æ±‚äººã«å¿œå‹Ÿã—ã¦ã„ã¾ã›ã‚“ã€‚<br>ä¼æ¥­ä¸€è¦§ã‹ã‚‰æ°—ã«ãªã‚‹æ±‚äººã‚’è¦‹ã¤ã‘ã¦å¿œå‹Ÿã—ã¦ãã ã•ã„ã€‚</p>
            <a href="job-list.html" class="btn btn-primary">
                ğŸ” æ±‚äººã‚’æ¢ã™
            </a>
        </div>
    </div>

    <!-- Detail Modal -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ“‹ å¿œå‹Ÿè©³ç´°</h3>
            </div>
            <div class="modal-body" id="detailContent">
                <!-- Content will be inserted here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="closeDetailModal()">é–‰ã˜ã‚‹</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, query, where, orderBy, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA6iFUhXOueccuoLJVU9ZSvXywHmj8zoR4",
            authDomain: "university-relocation-support.firebaseapp.com",
            projectId: "university-relocation-support",
            storageBucket: "university-relocation-support.firebasestorage.app",
            messagingSenderId: "849634495988",
            appId: "1:849634495988:web:013663976b0c4d6b4f7da1",
            measurementId: "G-RJP20TC7DV"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;
        let applications = [];
        let currentFilter = 'all';

        // Check authentication
        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUser = user;
                loadApplications();
            } else {
                window.location.href = 'log-in.html';
            }
        });

        // Load applications
        async function loadApplications() {
            try {
                const loading = document.getElementById('loading');
                const applicationList = document.getElementById('applicationList');
                const emptyState = document.getElementById('emptyState');
                const stats = document.getElementById('stats');

                loading.style.display = 'block';
                applicationList.style.display = 'none';
                emptyState.style.display = 'none';
                stats.style.display = 'none';

                // Query applications
                const applicationsRef = collection(db, 'applications');
                const q = query(
                    applicationsRef,
                    where('userId', '==', currentUser.uid),
                    orderBy('appliedAt', 'desc')
                );

                const querySnapshot = await getDocs(q);
                applications = [];

                querySnapshot.forEach((doc) => {
                    applications.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });

                loading.style.display = 'none';

                if (applications.length === 0) {
                    emptyState.style.display = 'block';
                } else {
                    stats.style.display = 'block';
                    applicationList.style.display = 'grid';
                    renderApplications();
                }
            } catch (error) {
                console.error('Error loading applications:', error);
                showAlert('å¿œå‹Ÿæƒ…å ±ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚', 'error');
                document.getElementById('loading').style.display = 'none';
            }
        }

        // Render applications
        function renderApplications() {
            const applicationList = document.getElementById('applicationList');
            const applicationCount = document.getElementById('applicationCount');
            
            let filteredApplications = applications;
            if (currentFilter !== 'all') {
                filteredApplications = applications.filter(app => app.status === currentFilter);
            }

            applicationCount.textContent = filteredApplications.length;

            if (filteredApplications.length === 0) {
                applicationList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ”</div>
                        <h2>è©²å½“ã™ã‚‹å¿œå‹ŸãŒã‚ã‚Šã¾ã›ã‚“</h2>
                        <p>ã“ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®å¿œå‹Ÿã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                    </div>
                `;
                return;
            }

            applicationList.innerHTML = filteredApplications.map(app => {
                const statusText = getStatusText(app.status);
                const statusClass = `status-${app.status}`;
                const appliedDate = app.appliedAt ? formatDate(app.appliedAt.toDate()) : 'æ—¥ä»˜ä¸æ˜';

                return `
                    <div class="application-card">
                        <div class="card-header">
                            <div class="card-info">
                                <div class="job-title">${app.jobTitle || 'æ±‚äººã‚¿ã‚¤ãƒˆãƒ«'}</div>
                                <div class="company-name">${app.companyName || 'ä¼æ¥­å'}</div>
                            </div>
                            <span class="status-badge ${statusClass}">${statusText}</span>
                        </div>
                        <div class="card-details">
                            <div class="detail-item">
                                <i class="fas fa-calendar detail-icon"></i>
                                <span>å¿œå‹Ÿæ—¥: ${appliedDate}</span>
                            </div>
                        </div>
                        <div class="timeline">
                            <div class="timeline-title">é¸è€ƒã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</div>
                            <div class="timeline-items">
                                <div class="timeline-item">
                                    <div class="timeline-dot ${app.status === 'applied' || app.status === 'screening' || app.status === 'interview' || app.status === 'offered' ? 'active' : ''}"></div>
                                    <span>å¿œå‹Ÿå®Œäº†</span>
                                </div>
                                <div class="timeline-item">
                                    <div class="timeline-dot ${app.status === 'screening' || app.status === 'interview' || app.status === 'offered' ? 'active' : ''}"></div>
                                    <span>æ›¸é¡é¸è€ƒ</span>
                                </div>
                                <div class="timeline-item">
                                    <div class="timeline-dot ${app.status === 'interview' || app.status === 'offered' ? 'active' : ''}"></div>
                                    <span>é¢æ¥</span>
                                </div>
                                <div class="timeline-item">
                                    <div class="timeline-dot ${app.status === 'offered' ? 'active' : ''}"></div>
                                    <span>å†…å®š</span>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <button class="btn btn-outline btn-small" onclick="showDetail('${app.id}')">
                                è©³ç´°ã‚’è¦‹ã‚‹
                            </button>
                            <button class="btn btn-primary btn-small" onclick="viewJob('${app.jobId}')">
                                æ±‚äººè©³ç´°
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Filter tabs
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentFilter = tab.dataset.status;
                renderApplications();
            });
        });

        // Show detail modal
        window.showDetail = function(applicationId) {
            const application = applications.find(app => app.id === applicationId);
            if (!application) return;

            const statusText = getStatusText(application.status);
            const appliedDate = application.appliedAt ? formatDate(application.appliedAt.toDate()) : 'æ—¥ä»˜ä¸æ˜';

            const detailContent = document.getElementById('detailContent');
            detailContent.innerHTML = `
                <div style="display: grid; gap: 20px;">
                    <div>
                        <h4 style="color: #64748b; font-size: 14px; margin-bottom: 8px;">æ±‚äººã‚¿ã‚¤ãƒˆãƒ«</h4>
                        <p style="font-size: 18px; font-weight: 700; color: #2d3748;">${application.jobTitle || 'æ±‚äººã‚¿ã‚¤ãƒˆãƒ«'}</p>
                    </div>
                    <div>
                        <h4 style="color: #64748b; font-size: 14px; margin-bottom: 8px;">ä¼æ¥­å</h4>
                        <p style="color: #2d3748;">${application.companyName || 'ä¼æ¥­å'}</p>
                    </div>
                    <div>
                        <h4 style="color: #64748b; font-size: 14px; margin-bottom: 8px;">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h4>
                        <span class="status-badge status-${application.status}">${statusText}</span>
                    </div>
                    <div>
                        <h4 style="color: #64748b; font-size: 14px; margin-bottom: 8px;">å¿œå‹Ÿæ—¥</h4>
                        <p style="color: #2d3748;">${appliedDate}</p>
                    </div>
                </div>
            `;

            document.getElementById('detailModal').classList.add('active');
        };

        // Close detail modal
        window.closeDetailModal = function() {
            document.getElementById('detailModal').classList.remove('active');
        };

        // View job
        window.viewJob = function(jobId) {
            window.location.href = `job-detail.html?id=${jobId}`;
        };

        // Show alert
        function showAlert(message, type = 'success') {
            const alertContainer = document.getElementById('alertContainer');
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.innerHTML = `
                <span>${type === 'success' ? 'âœ“' : 'âš '}</span>
                <span>${message}</span>
            `;
            alertContainer.appendChild(alert);

            setTimeout(() => {
                alert.remove();
            }, 5000);
        }

        // Format date
        function formatDate(date) {
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            return `${year}å¹´${month}æœˆ${day}æ—¥`;
        }

        // Get status text
        function getStatusText(status) {
            const statusMap = {
                'applied': 'å¿œå‹Ÿæ¸ˆã¿',
                'screening': 'æ›¸é¡é¸è€ƒä¸­',
                'interview': 'é¢æ¥',
                'offered': 'å†…å®š',
                'rejected': 'ä¸æ¡ç”¨'
            };
            return statusMap[status] || status;
        }

        // Close modal on outside click
        document.getElementById('detailModal').addEventListener('click', (e) => {
            if (e.target.id === 'detailModal') {
                closeDetailModal();
            }
        });
    </script>

    <!-- Schema.org structured data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "å¿œå‹Ÿç®¡ç†",
      "description": "å¿œå‹Ÿã—ãŸæ±‚äººã®ç®¡ç†ã¨é€²æ—ç¢ºèª",
      "url": "https://hiyusho.github.io/university-relocation-support/job-applications.html"
    }
    </script>
</body>
</html>
